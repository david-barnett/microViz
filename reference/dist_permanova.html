<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate PERMANOVA after dist_calc() — dist_permanova • microViz</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate PERMANOVA after dist_calc() — dist_permanova"><meta name="description" content="dist_permanova runs a Permutational Multivariate ANOVA (aka Non-parametric MANOVA).
This is a way to test for the statistical significance of (independent)
associations between variables in your phyloseq::sample_data(),
and a microbiota distance matrix you have already calculated with dist_calc().
This function is a wrapper around vegan's adonis2() function. See ?vegan::adonis2() for more insight.
You can also read this excellent book chapter on PERMANOVA by Marti Anderson:
doi:10.1002/9781118445112.stat07841
Or this NPMANOVA page on GUSTA ME:
https://sites.google.com/site/mb3gustame/hypothesis-tests/manova/npmanova"><meta property="og:description" content="dist_permanova runs a Permutational Multivariate ANOVA (aka Non-parametric MANOVA).
This is a way to test for the statistical significance of (independent)
associations between variables in your phyloseq::sample_data(),
and a microbiota distance matrix you have already calculated with dist_calc().
This function is a wrapper around vegan's adonis2() function. See ?vegan::adonis2() for more insight.
You can also read this excellent book chapter on PERMANOVA by Marti Anderson:
doi:10.1002/9781118445112.stat07841
Or this NPMANOVA page on GUSTA ME:
https://sites.google.com/site/mb3gustame/hypothesis-tests/manova/npmanova"><meta property="og:image" content="https://david-barnett.github.io/microViz/logo.png"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-2YQ669S4V5"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-2YQ669S4V5');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">microViz</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.12.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/shao19-analyses.html">Getting Started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/web-only/phyloseq.html">Working with phyloseq objects</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/tax-fixing.html">Fixing your tax_table</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/ordination.html">Ordination plots</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/ordination-interactive.html">Interactive ordination plots</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/compositions.html">Visualising compositions with barplots</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/heatmaps.html">Heatmaps of microbiome composition or correlation</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/modelling-taxa.html">Statistical modelling of individual taxa</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/videos.html">Tutorial video</a></li>
    <li><a class="dropdown-item" href="../articles/ps_extra-replaced.html">Upgrading to microViz version 0.10.0</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/atlas1006.html">Example analyses with atlas1006 data</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/learn/exercises.html">Learn</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item"><h6 class="dropdown-header" data-toc-skip></h6></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/david-barnett/microViz/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate PERMANOVA after dist_calc()</h1>
      <small class="dont-index">Source: <a href="https://github.com/david-barnett/microViz/blob/main/R/dist_permanova.R" class="external-link"><code>R/dist_permanova.R</code></a></small>
      <div class="d-none name"><code>dist_permanova.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>dist_permanova</code> runs a Permutational Multivariate ANOVA (aka Non-parametric MANOVA).
This is a way to test for the statistical significance of (independent)
associations between variables in your phyloseq::sample_data(),
and a microbiota distance matrix you have already calculated with dist_calc().</p>
<p>This function is a wrapper around vegan's <code><a href="https://rdrr.io/pkg/vegan/man/adonis.html" class="external-link">adonis2()</a></code> function. See <code>?vegan::adonis2()</code> for more insight.</p>
<p>You can also read this excellent book chapter on PERMANOVA by Marti Anderson:
<a href="https://doi.org/10.1002/9781118445112.stat07841" class="external-link">doi:10.1002/9781118445112.stat07841</a></p>
<p>Or this NPMANOVA page on GUSTA ME:
<a href="https://sites.google.com/site/mb3gustame/hypothesis-tests/manova/npmanova" class="external-link">https://sites.google.com/site/mb3gustame/hypothesis-tests/manova/npmanova</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dist_permanova</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  variables <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  interactions <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  complete_cases <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_processes <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  n_perms <span class="op">=</span> <span class="fl">999</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  by <span class="op">=</span> <span class="st">"margin"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>psExtra output from dist_calc()</p></dd>


<dt id="arg-variables">variables<a class="anchor" aria-label="anchor" href="#arg-variables"></a></dt>
<dd><p>character vector of variables to include in model or character representation of the right-hand side of a formula, e.g "varA + varB + varA:varB"</p></dd>


<dt id="arg-interactions">interactions<a class="anchor" aria-label="anchor" href="#arg-interactions"></a></dt>
<dd><p>optional argument to define any interactions between variables, written in the style of e.g. "var_a * var_b"</p></dd>


<dt id="arg-complete-cases">complete_cases<a class="anchor" aria-label="anchor" href="#arg-complete-cases"></a></dt>
<dd><p>if TRUE, drops observations if they contain missing values (otherwise stops if missings are detected)</p></dd>


<dt id="arg-n-processes">n_processes<a class="anchor" aria-label="anchor" href="#arg-n-processes"></a></dt>
<dd><p>how many parallel processes to use? (on windows this uses parallel::makePSOCKcluster())</p></dd>


<dt id="arg-n-perms">n_perms<a class="anchor" aria-label="anchor" href="#arg-n-perms"></a></dt>
<dd><p>how many permutations? e.g. 9999. Less is faster but more is better!</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>set a random number generator seed to ensure you get the same results each run</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>passed to vegan::adonis2() <code>by</code> argument: what type of sums of squares to calculate? "margin" or "terms"</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>sends messages about progress if TRUE</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments are passed directly to vegan::adonis2() (e.g. strata, add, sqrt.dist etc.)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>psExtra list containing permanova results and (filtered) input objects</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The variables argument will be collapsed into one string (if length &gt; 1) by pasting together, separated by "+".
Any interaction terms described in the interactions argument will be pasted onto the end of the pasted variables argument.
Alternatively, you can supply the complete right hand side of the formula yourself e.g variables = "varA + varB + varC\*varD"</p>
<p>Watch out, if any of your variable names contain characters that would normally separate variables in a formula then
you should rename the offending variable (e.g. avoid any of "+" "\*" "|" or ":" ) otherwise permanova will split that variable into pieces.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="dist_calc.html">dist_calc</a></code> for calculating the required distance matrix input</p>
<p><code><a href="ord_plot.html">ord_plot</a></code> with constraints as a way to visualise the microbial associations of significant predictors</p>
<p><code>vegan::<a href="https://rdrr.io/pkg/vegan/man/adonis.html" class="external-link">adonis2</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"dietswap"</span>, package <span class="op">=</span> <span class="st">"microbiome"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># add some missings to demonstrate automated removal</span></span></span>
<span class="r-in"><span><span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/sample_data-methods.html" class="external-link">sample_data</a></span><span class="op">(</span><span class="va">dietswap</span><span class="op">)</span><span class="op">$</span><span class="va">sex</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compute distance</span></span></span>
<span class="r-in"><span><span class="va">testDist</span> <span class="op">&lt;-</span> <span class="va">dietswap</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="tax_agg.html">tax_agg</a></span><span class="op">(</span><span class="st">"Genus"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="tax_transform.html">tax_transform</a></span><span class="op">(</span><span class="st">"identity"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="dist_calc.html">dist_calc</a></span><span class="op">(</span><span class="st">"bray"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">PERM</span> <span class="op">&lt;-</span> <span class="va">testDist</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dist_permanova</span><span class="op">(</span></span></span>
<span class="r-in"><span>    seed <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sex"</span>, <span class="st">"bmi_group"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    n_processes <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    n_perms <span class="op">=</span> <span class="fl">99</span> <span class="co"># only 99 perms used in examples for speed (use 9999+!)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Dropping samples with missings: 4</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2025-04-14 11:43:12.428129 - Starting PERMANOVA with 99 perms with 1 processes</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2025-04-14 11:43:12.578329 - Finished PERMANOVA</span>
<span class="r-in"><span><span class="va">PERM</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> psExtra object - a phyloseq object with extra slots:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phyloseq-class experiment-level object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> otu_table()   OTU Table:         [ 130 taxa and 218 samples ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample_data() Sample Data:       [ 218 samples by 8 sample variables ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tax_table()   Taxonomy Table:    [ 130 taxa by 3 taxonomic ranks ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> psExtra info:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tax_agg = "Genus" tax_trans = "identity" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bray distance matrix of size 218 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.7639533 0.731024 0.7283254 0.6637252 0.7437293 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> permanova:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation test for adonis under reduced model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal effects of terms</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation: free</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permutations: 99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> vegan::adonis2(formula = formula, data = metadata, permutations = n_perms, by = by, parallel = parall)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Df SumOfSqs      R2      F Pr(&gt;F)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sex         1    0.361 0.00933 2.1539   0.10 . </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bmi_group   2    2.377 0.06143 7.0888   0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual  214   35.874 0.92720                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total     217   38.691 1.00000                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">PERM</span>, max.level <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formal class 'psExtra' [package "microViz"] with 15 slots</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># try permanova with interaction terms</span></span></span>
<span class="r-in"><span><span class="va">PERM2</span> <span class="op">&lt;-</span> <span class="va">testDist</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dist_permanova</span><span class="op">(</span></span></span>
<span class="r-in"><span>    seed <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    variables <span class="op">=</span> <span class="st">"nationality + sex * bmi_group"</span>,</span></span>
<span class="r-in"><span>    n_processes <span class="op">=</span> <span class="fl">1</span>, n_perms <span class="op">=</span> <span class="fl">99</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Dropping samples with missings: 4</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2025-04-14 11:43:12.601057 - Starting PERMANOVA with 99 perms with 1 processes</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2025-04-14 11:43:12.797481 - Finished PERMANOVA</span>
<span class="r-in"><span><span class="fu"><a href="psExtra-accessors.html">perm_get</a></span><span class="op">(</span><span class="va">PERM2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation test for adonis under reduced model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal effects of terms</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation: free</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permutations: 99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> vegan::adonis2(formula = formula, data = metadata, permutations = n_perms, by = by, parallel = parall)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Df SumOfSqs      R2       F Pr(&gt;F)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nationality     1    4.859 0.12558 34.2219   0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sex:bmi_group   1    0.321 0.00828  2.2576   0.06 . </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual      212   30.099 0.77794                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total         217   38.691 1.00000                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># specify the same model in alternative way</span></span></span>
<span class="r-in"><span><span class="va">PERM3</span> <span class="op">&lt;-</span> <span class="va">testDist</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dist_permanova</span><span class="op">(</span></span></span>
<span class="r-in"><span>    seed <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nationality"</span>, <span class="st">"sex"</span>, <span class="st">"bmi_group"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    interactions <span class="op">=</span> <span class="st">"sex * bmi_group"</span>,</span></span>
<span class="r-in"><span>    n_processes <span class="op">=</span> <span class="fl">1</span>, n_perms <span class="op">=</span> <span class="fl">99</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Dropping samples with missings: 4</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2025-04-14 11:43:12.827799 - Starting PERMANOVA with 99 perms with 1 processes</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2025-04-14 11:43:13.014247 - Finished PERMANOVA</span>
<span class="r-in"><span><span class="fu"><a href="psExtra-accessors.html">perm_get</a></span><span class="op">(</span><span class="va">PERM3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation test for adonis under reduced model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Marginal effects of terms</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Permutation: free</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of permutations: 99</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> vegan::adonis2(formula = formula, data = metadata, permutations = n_perms, by = by, parallel = parall)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                Df SumOfSqs      R2       F Pr(&gt;F)   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> nationality     1    4.859 0.12558 34.2219   0.01 **</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sex:bmi_group   1    0.321 0.00828  2.2576   0.06 . </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual      212   30.099 0.77794                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total         217   38.691 1.00000                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">PERM3</span>, <span class="va">PERM2</span><span class="op">)</span> <span class="co"># TRUE</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># take same distance matrix used for the permanova and plot an ordination</span></span></span>
<span class="r-in"><span><span class="va">PERM2</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="ord_calc.html">ord_calc</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"PCoA"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="ord_plot.html">ord_plot</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"bmi_group"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="dist_permanova-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># this trick ensures any samples dropped from the permanova</span></span></span>
<span class="r-in"><span><span class="co"># for having missing values in the covariates are NOT included</span></span></span>
<span class="r-in"><span><span class="co"># in the corresponding ordination plot</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Barnett.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>



  <script data-goatcounter="https://microviz.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script></body></html>

