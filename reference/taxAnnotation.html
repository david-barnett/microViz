<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Helper to specify a HeatmapAnnotation for taxa — taxAnnotation • microViz</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Helper to specify a HeatmapAnnotation for taxa — taxAnnotation"><meta name="description" content="Helper to specify a HeatmapAnnotation for taxa"><meta property="og:description" content="Helper to specify a HeatmapAnnotation for taxa"><meta property="og:image" content="https://david-barnett.github.io/microViz/logo.png"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-2YQ669S4V5"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-2YQ669S4V5');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">microViz</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.12.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/shao19-analyses.html">Getting Started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/web-only/phyloseq.html">Working with phyloseq objects</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/tax-fixing.html">Fixing your tax_table</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/ordination.html">Ordination plots</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/ordination-interactive.html">Interactive ordination plots</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/compositions.html">Visualising compositions with barplots</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/heatmaps.html">Heatmaps of microbiome composition or correlation</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/modelling-taxa.html">Statistical modelling of individual taxa</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/videos.html">Tutorial video</a></li>
    <li><a class="dropdown-item" href="../articles/ps_extra-replaced.html">Upgrading to microViz version 0.10.0</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/atlas1006.html">Example analyses with atlas1006 data</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/learn/exercises.html">Learn</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item"><h6 class="dropdown-header" data-toc-skip></h6></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/david-barnett/microViz/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Helper to specify a HeatmapAnnotation for taxa</h1>
      <small class="dont-index">Source: <a href="https://github.com/david-barnett/microViz/blob/main/R/heatmaps-taxAnnotation.R" class="external-link"><code>R/heatmaps-taxAnnotation.R</code></a></small>
      <div class="d-none name"><code>taxAnnotation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Helper to specify a HeatmapAnnotation for taxa</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">taxAnnotation</span><span class="op">(</span></span>
<span>  <span class="va">...</span>,</span>
<span>  <span class="va">name</span>,</span>
<span>  annotation_legend_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  show_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  border <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  gap <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">"mm"</span><span class="op">)</span>,</span>
<span>  show_annotation_name <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  annotation_label <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annotation_name_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  annotation_name_offset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annotation_name_rot <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  annotation_name_align <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  annotation_name_side <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  .data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  .taxa <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  .side <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Name-value pairs where the names correspond to annotation names and values
are the output of taxon annotation functions such as anno_tax_prev() or
manually specified AnnotationFunction objects</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>Name of the heatmap annotation, optional.</p></dd>


<dt id="arg-annotation-legend-param">annotation_legend_param<a class="anchor" aria-label="anchor" href="#arg-annotation-legend-param"></a></dt>
<dd><p>A list which contains parameters for annotation legends. See <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/color_mapping_legend-ColorMapping-method.html" class="external-link">color_mapping_legend,ColorMapping-method</a></code> for all possible options.</p></dd>


<dt id="arg-show-legend">show_legend<a class="anchor" aria-label="anchor" href="#arg-show-legend"></a></dt>
<dd><p>Whether show annotation legends. The value can be one single value or a vector.</p></dd>


<dt id="arg-gp">gp<a class="anchor" aria-label="anchor" href="#arg-gp"></a></dt>
<dd><p>Graphic parameters for simple annotations (with <code>fill</code> parameter ignored).</p></dd>


<dt id="arg-border">border<a class="anchor" aria-label="anchor" href="#arg-border"></a></dt>
<dd><p>border of single annotations.</p></dd>


<dt id="arg-gap">gap<a class="anchor" aria-label="anchor" href="#arg-gap"></a></dt>
<dd><p>Gap between annotations. It can be a single value or a vector of <code><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></code> objects.</p></dd>


<dt id="arg-show-annotation-name">show_annotation_name<a class="anchor" aria-label="anchor" href="#arg-show-annotation-name"></a></dt>
<dd><p>Whether show annotation names? For column annotation, annotation names are drawn either on the left or the right, and for row annotations, names are draw either on top or at the bottom. The value can be a vector.</p></dd>


<dt id="arg-annotation-label">annotation_label<a class="anchor" aria-label="anchor" href="#arg-annotation-label"></a></dt>
<dd><p>Labels for the annotations. By default it is the same as individual annotation names.</p></dd>


<dt id="arg-annotation-name-gp">annotation_name_gp<a class="anchor" aria-label="anchor" href="#arg-annotation-name-gp"></a></dt>
<dd><p>Graphic parameters for annotation names. Graphic parameters can be vectors.</p></dd>


<dt id="arg-annotation-name-offset">annotation_name_offset<a class="anchor" aria-label="anchor" href="#arg-annotation-name-offset"></a></dt>
<dd><p>Offset to the annotation names, a <code><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></code> object. The value can be a vector.</p></dd>


<dt id="arg-annotation-name-rot">annotation_name_rot<a class="anchor" aria-label="anchor" href="#arg-annotation-name-rot"></a></dt>
<dd><p>Rotation of the annotation names. The value can be a vector.</p></dd>


<dt id="arg-annotation-name-align">annotation_name_align<a class="anchor" aria-label="anchor" href="#arg-annotation-name-align"></a></dt>
<dd><p>Whether to align the annotation names.</p></dd>


<dt id="arg-annotation-name-side">annotation_name_side<a class="anchor" aria-label="anchor" href="#arg-annotation-name-side"></a></dt>
<dd><p>Side of the annotation names.</p></dd>


<dt id="arg--data">.data<a class="anchor" aria-label="anchor" href="#arg--data"></a></dt>
<dd><p>OPTIONAL phyloseq or psExtra,
only set this to override use of same data as in heatmap</p></dd>


<dt id="arg--taxa">.taxa<a class="anchor" aria-label="anchor" href="#arg--taxa"></a></dt>
<dd><p>OPTIONAL selection vector of taxa (names, numbers or logical),
only set this if providing .data argument to override default</p></dd>


<dt id="arg--side">.side<a class="anchor" aria-label="anchor" href="#arg--side"></a></dt>
<dd><p>OPTIONAL string, indicating the side the taxa annotation should be placed:
only set this to override default</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>HeatmapAnnotation object</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/jokergoo/ComplexHeatmap" class="external-link">"ComplexHeatmap"</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ibd"</span>, package <span class="op">=</span> <span class="st">"microViz"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">psq</span> <span class="op">&lt;-</span> <span class="fu"><a href="tax_filter.html">tax_filter</a></span><span class="op">(</span><span class="va">ibd</span>, min_prevalence <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">psq</span> <span class="op">&lt;-</span> <span class="fu"><a href="tax_mutate.html">tax_mutate</a></span><span class="op">(</span><span class="va">psq</span>, Species <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">psq</span> <span class="op">&lt;-</span> <span class="fu"><a href="tax_fix.html">tax_fix</a></span><span class="op">(</span><span class="va">psq</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">psq</span> <span class="op">&lt;-</span> <span class="fu"><a href="tax_agg.html">tax_agg</a></span><span class="op">(</span><span class="va">psq</span>, rank <span class="op">=</span> <span class="st">"Family"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">taxa</span> <span class="op">&lt;-</span> <span class="fu"><a href="tax_top.html">tax_top</a></span><span class="op">(</span><span class="va">psq</span>, n <span class="op">=</span> <span class="fl">15</span>, rank <span class="op">=</span> <span class="st">"Family"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">customAxis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>labels_rot <span class="op">=</span> <span class="fl">0</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># makes a function that takes data, taxa and which (at minimum)</span></span></span>
<span class="r-in"><span><span class="va">fun</span> <span class="op">&lt;-</span> <span class="fu">taxAnnotation</span><span class="op">(</span></span></span>
<span class="r-in"><span>  gap <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="st">"mm"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  Prev. <span class="op">=</span> <span class="fu"><a href="anno_tax_prev.html">anno_tax_prev</a></span><span class="op">(</span>axis_param <span class="op">=</span> <span class="va">customAxis</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, extend <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  `Prop. Abd.` <span class="op">=</span> <span class="fu"><a href="anno_tax_box.html">anno_tax_box</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">40</span>, <span class="st">"mm"</span><span class="op">)</span>, axis_param <span class="op">=</span> <span class="va">customAxis</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  `Log10p Abd.` <span class="op">=</span> <span class="fu"><a href="anno_tax_density.html">anno_tax_density</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"heatmap"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># manually specify the prevalence barplot function by giving it data etc.</span></span></span>
<span class="r-in"><span><span class="va">heatmapAnnoFunction</span> <span class="op">&lt;-</span> <span class="fu">fun</span><span class="op">(</span>.data <span class="op">=</span> <span class="va">psq</span>, .side <span class="op">=</span> <span class="st">"top"</span>, .taxa <span class="op">=</span> <span class="va">taxa</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># draw the annotation without a heatmap, you will never normally do this!</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grid/grid.newpage.html" class="external-link">grid.newpage</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">vp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grid/viewport.html" class="external-link">viewport</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.65</span>, height <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grid/viewports.html" class="external-link">pushViewport</a></span><span class="op">(</span><span class="va">vp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">heatmapAnnoFunction</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="taxAnnotation-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># try again as a row annotation</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grid/grid.newpage.html" class="external-link">grid.newpage</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/grid/viewports.html" class="external-link">pushViewport</a></span><span class="op">(</span><span class="va">vp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span><span class="fu">fun</span><span class="op">(</span>.data <span class="op">=</span> <span class="va">psq</span>, .side <span class="op">=</span> <span class="st">"right"</span>, .taxa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">taxa</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="taxAnnotation-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Barnett.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>



  <script data-goatcounter="https://microviz.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script></body></html>

