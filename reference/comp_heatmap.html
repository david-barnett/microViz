<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Heatmap of taxonomic composition across samples — comp_heatmap • microViz</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Heatmap of taxonomic composition across samples — comp_heatmap" />
<meta property="og:description" content="Heatmap made with ComplexHeatmap, with optional (but default) annotation of taxa prevalence and abundance.
Transform your data with tax_transform prior to plotting (and/or scale with tax_scale).
Plotting &quot;compositional&quot; data can give an idea of the dominant taxa in each sample.
Plotting some form of log or clr transformed (or scaled) microbial features can highlight
other patterns.
The transformed data will be ordered via your selected seriation methods and distances.
Any cell numbers printed can be set to different values, and do not affect ordering." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2YQ669S4V5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-2YQ669S4V5');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">microViz</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.8.0.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/web-only/phyloseq.html">Working with phyloseq objects</a>
    </li>
    <li>
      <a href="../articles/web-only/tax-fixing.html">Fixing your tax_table</a>
    </li>
    <li>
      <a href="../articles/web-only/ordination.html">Ordination plots</a>
    </li>
    <li>
      <a href="../articles/web-only/ordination-interactive.html">Interactive ordination plots</a>
    </li>
    <li>
      <a href="../articles/web-only/compositions.html">Visualising microbiota compositions</a>
    </li>
    <li>
      <a href="../articles/web-only/modelling-taxa.html">Statistical modelling of individual taxa</a>
    </li>
    <li>
      <a href="../articles/web-only/videos.html">Tutorial video</a>
    </li>
    <li>
      <a href="../articles/web-only/atlas1006.html">Example analyses with atlas1006 data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown-header"></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/david-barnett/microViz/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Heatmap of taxonomic composition across samples</h1>
    <small class="dont-index">Source: <a href='https://github.com/david-barnett/microViz/blob/master/R/heatmaps.R'><code>R/heatmaps.R</code></a></small>
    <div class="hidden name"><code>comp_heatmap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Heatmap made with ComplexHeatmap, with optional (but default) annotation of taxa prevalence and abundance.</p>
<p>Transform your data with tax_transform prior to plotting (and/or scale with tax_scale).
Plotting "compositional" data can give an idea of the dominant taxa in each sample.
Plotting some form of log or clr transformed (or scaled) microbial features can highlight
other patterns.
The transformed data will be ordered via your selected seriation methods and distances.
Any cell numbers printed can be set to different values, and do not affect ordering.</p>
    </div>

    <pre class="usage"><span class='fu'>comp_heatmap</span><span class='op'>(</span>
  <span class='va'>data</span>,
  taxa <span class='op'>=</span> <span class='fu'>phyloseq</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/phyloseq/man/taxa_names-methods.html'>taxa_names</a></span><span class='op'>(</span><span class='fu'><a href='ps_extra-accessors.html'>ps_get</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span><span class='op'>)</span>,
  samples <span class='op'>=</span> <span class='fu'>phyloseq</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/phyloseq/man/sample_names-methods.html'>sample_names</a></span><span class='op'>(</span><span class='fu'><a href='ps_extra-accessors.html'>ps_get</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span><span class='op'>)</span>,
  anno_tax <span class='op'>=</span> <span class='cn'>NULL</span>,
  anno_samples <span class='op'>=</span> <span class='cn'>NULL</span>,
  colors <span class='op'>=</span> <span class='fu'><a href='heat_palette.html'>heat_palette</a></span><span class='op'>(</span>palette <span class='op'>=</span> <span class='st'>"Greens"</span>, rev <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
  numbers <span class='op'>=</span> <span class='cn'>NULL</span>,
  taxa_side <span class='op'>=</span> <span class='st'>"right"</span>,
  seriation_method <span class='op'>=</span> <span class='st'>"OLO_ward"</span>,
  seriation_dist <span class='op'>=</span> <span class='st'>"euclidean"</span>,
  seriation_method_col <span class='op'>=</span> <span class='va'>seriation_method</span>,
  seriation_dist_col <span class='op'>=</span> <span class='va'>seriation_dist</span>,
  tax_transform_numbers <span class='op'>=</span> <span class='st'>"identity"</span>,
  tax_scale_numbers <span class='op'>=</span> <span class='st'>"neither"</span>,
  gridlines <span class='op'>=</span> <span class='fu'><a href='heat_grid.html'>heat_grid</a></span><span class='op'>(</span>lwd <span class='op'>=</span> <span class='fl'>0.1</span>, col <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span>,
  name <span class='op'>=</span> <span class='st'>"mat"</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>phyloseq extra output of tax_transform or tax_agg</p></td>
    </tr>
    <tr>
      <th>taxa</th>
      <td><p>list of taxa to include (selection occurs AFTER any tax_transform and scaling)</p></td>
    </tr>
    <tr>
      <th>samples</th>
      <td><p>list of taxa to include (selection occurs AFTER any tax_transform and scaling)</p></td>
    </tr>
    <tr>
      <th>anno_tax</th>
      <td><p>NULL or tax_anno() list output</p></td>
    </tr>
    <tr>
      <th>anno_samples</th>
      <td><p>NULL only support so far TODO</p></td>
    </tr>
    <tr>
      <th>colors</th>
      <td><p>output of heat_palette() to set heatmap fill color scheme</p></td>
    </tr>
    <tr>
      <th>numbers</th>
      <td><p>NULL or output of heat_numbers() to draw numbers on heatmap cells</p></td>
    </tr>
    <tr>
      <th>taxa_side</th>
      <td><p>controls heatmap orientation and where any anno_tax annotations are placed (top/bottom/left/right)</p></td>
    </tr>
    <tr>
      <th>seriation_method</th>
      <td><p>method to order the rows (in seriation::seriate)</p></td>
    </tr>
    <tr>
      <th>seriation_dist</th>
      <td><p>distance to use in seriation_method (if needed)</p></td>
    </tr>
    <tr>
      <th>seriation_method_col</th>
      <td><p>method to order the columns (in seriation::seriate)</p></td>
    </tr>
    <tr>
      <th>seriation_dist_col</th>
      <td><p>distance to use in seriation_method_col (if needed)</p></td>
    </tr>
    <tr>
      <th>tax_transform_numbers</th>
      <td><p>transformation applied to otu_table used only for any numbers printed</p></td>
    </tr>
    <tr>
      <th>tax_scale_numbers</th>
      <td><p>scaling applied to numbers otu_table after transformation</p></td>
    </tr>
    <tr>
      <th>gridlines</th>
      <td><p>list output of heat_grid() for setting gridline style</p></td>
    </tr>
    <tr>
      <th>name</th>
      <td><p>used as legend title (colourbar)</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>extra args, passed to viz_heatmap internal function</p></td>
    </tr>
    </table>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"dietswap"</span>, package <span class='op'>=</span> <span class='st'>"microbiome"</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>psq</span> <span class='op'>&lt;-</span> <span class='fu'><a href='tax_filter.html'>tax_filter</a></span><span class='op'>(</span><span class='va'>dietswap</span>, min_prevalence <span class='op'>=</span> <span class='fl'>1</span> <span class='op'>/</span> <span class='fl'>10</span>, min_sample_abundance <span class='op'>=</span> <span class='fl'>1</span> <span class='op'>/</span> <span class='fl'>10</span><span class='op'>)</span></span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Proportional min_prevalence given: 0.1 --&gt; min 23/222 samples.</span>
<span class='r-in'><span class='va'>psq</span> <span class='op'>&lt;-</span> <span class='fu'><a href='tax_agg.html'>tax_agg</a></span><span class='op'>(</span><span class='va'>psq</span>, <span class='st'>"Genus"</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>taxa</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fu'>microbiome</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/microbiome/man/top_taxa.html'>top_taxa</a></span><span class='op'>(</span><span class='fu'><a href='ps_extra-accessors.html'>ps_get</a></span><span class='op'>(</span><span class='va'>psq</span><span class='op'>)</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>50</span><span class='op'>]</span>, size <span class='op'>=</span> <span class='fl'>30</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>psq</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'><a href='tax_transform.html'>tax_transform</a></span><span class='op'>(</span><span class='st'>"clr"</span><span class='op'>)</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'>comp_heatmap</span><span class='op'>(</span>taxa <span class='op'>=</span> <span class='va'>taxa</span>, anno_tax <span class='op'>=</span> <span class='fu'><a href='heatmap-annotations.html'>tax_anno</a></span><span class='op'>(</span>undetected <span class='op'>=</span> <span class='fl'>50</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>p</span></span>
<span class='r-plt img'><img src='comp_heatmap-1.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># set the colour range yourself</span></span>
<span class='r-in'><span class='va'>psq</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'><a href='tax_transform.html'>tax_transform</a></span><span class='op'>(</span><span class='st'>"clr"</span><span class='op'>)</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'>comp_heatmap</span><span class='op'>(</span></span>
<span class='r-in'>    taxa <span class='op'>=</span> <span class='va'>taxa</span>, anno_tax <span class='op'>=</span> <span class='fu'><a href='heatmap-annotations.html'>tax_anno</a></span><span class='op'>(</span>undetected <span class='op'>=</span> <span class='fl'>50</span><span class='op'>)</span>,</span>
<span class='r-in'>    colors <span class='op'>=</span> <span class='fu'><a href='heat_palette.html'>heat_palette</a></span><span class='op'>(</span>palette <span class='op'>=</span> <span class='st'>"Greens"</span>, rev <span class='op'>=</span> <span class='cn'>TRUE</span>, range <span class='op'>=</span> <span class='fl'>0</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>)</span></span>
<span class='r-in'>  <span class='op'>)</span></span>
<span class='r-plt img'><img src='comp_heatmap-2.png' alt='' width='700' height='433' /></span>
<span class='r-in'><span class='va'>psq</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'><a href='tax_transform.html'>tax_transform</a></span><span class='op'>(</span><span class='st'>"clr"</span><span class='op'>)</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'>comp_heatmap</span><span class='op'>(</span></span>
<span class='r-in'>    taxa <span class='op'>=</span> <span class='va'>taxa</span>, anno_tax <span class='op'>=</span> <span class='fu'><a href='heatmap-annotations.html'>tax_anno</a></span><span class='op'>(</span>undetected <span class='op'>=</span> <span class='fl'>50</span><span class='op'>)</span>,</span>
<span class='r-in'>    colors <span class='op'>=</span> <span class='fu'><a href='heat_palette.html'>heat_palette</a></span><span class='op'>(</span>palette <span class='op'>=</span> <span class='st'>"Green-Orange"</span>, range <span class='op'>=</span> <span class='fl'>0</span><span class='op'>:</span><span class='fl'>5</span>, sym <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span class='r-in'>  <span class='op'>)</span></span>
<span class='r-plt img'><img src='comp_heatmap-3.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># supply a different colour palette to heat_palette (match breaks to length)</span></span>
<span class='r-in'><span class='va'>psq</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'><a href='tax_transform.html'>tax_transform</a></span><span class='op'>(</span><span class='st'>"clr"</span><span class='op'>)</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'>comp_heatmap</span><span class='op'>(</span></span>
<span class='r-in'>    taxa <span class='op'>=</span> <span class='va'>taxa</span>, anno_tax <span class='op'>=</span> <span class='fu'><a href='heatmap-annotations.html'>tax_anno</a></span><span class='op'>(</span>undetected <span class='op'>=</span> <span class='fl'>50</span><span class='op'>)</span>,</span>
<span class='r-in'>    colors <span class='op'>=</span> <span class='fu'><a href='heat_palette.html'>heat_palette</a></span><span class='op'>(</span>palette <span class='op'>=</span> <span class='fu'>viridisLite</span><span class='fu'>::</span><span class='fu'><a href='https://sjmgarnier.github.io/viridisLite/reference/viridis.html'>turbo</a></span><span class='op'>(</span><span class='fl'>12</span><span class='op'>)</span>, breaks <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span></span>
<span class='r-in'>  <span class='op'>)</span></span>
<span class='r-plt img'><img src='comp_heatmap-4.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># you can place the legend at the bottom, but it is a little complicated</span></span>
<span class='r-in'><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>psq</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'><a href='tax_transform.html'>tax_transform</a></span><span class='op'>(</span><span class='st'>"clr"</span><span class='op'>)</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'>comp_heatmap</span><span class='op'>(</span></span>
<span class='r-in'>    taxa <span class='op'>=</span> <span class='va'>taxa</span>, anno_tax <span class='op'>=</span> <span class='fu'><a href='heatmap-annotations.html'>tax_anno</a></span><span class='op'>(</span>undetected <span class='op'>=</span> <span class='fl'>50</span><span class='op'>)</span>, name <span class='op'>=</span> <span class='st'>"auto"</span>,</span>
<span class='r-in'>    heatmap_legend_param <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>direction <span class='op'>=</span> <span class='st'>"horizontal"</span>, title_position <span class='op'>=</span> <span class='st'>"lefttop"</span><span class='op'>)</span></span>
<span class='r-in'>  <span class='op'>)</span></span>
<span class='r-in'><span class='fu'>ComplexHeatmap</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html'>draw</a></span><span class='op'>(</span><span class='va'>p</span>,</span>
<span class='r-in'>  heatmap_legend_side <span class='op'>=</span> <span class='st'>"bottom"</span>, adjust_annotation_extension <span class='op'>=</span> <span class='cn'>FALSE</span></span>
<span class='r-in'><span class='op'>)</span></span>
<span class='r-plt img'><img src='comp_heatmap-5.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># rotate plot to have taxa as columns, annotated at the bottom</span></span>
<span class='r-in'><span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='va'>psq</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'><a href='tax_transform.html'>tax_transform</a></span><span class='op'>(</span><span class='st'>"clr"</span><span class='op'>)</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'>comp_heatmap</span><span class='op'>(</span></span>
<span class='r-in'>    taxa <span class='op'>=</span> <span class='va'>taxa</span>, taxa_side <span class='op'>=</span> <span class='st'>"bottom"</span>, anno_tax <span class='op'>=</span> <span class='fu'><a href='heatmap-annotations.html'>tax_anno</a></span><span class='op'>(</span>undetected <span class='op'>=</span> <span class='fl'>50</span><span class='op'>)</span></span>
<span class='r-in'>  <span class='op'>)</span></span>
<span class='r-in'><span class='va'>p2</span></span>
<span class='r-plt img'><img src='comp_heatmap-6.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># log2 transform data before plotting and automatic naming of scale</span></span>
<span class='r-in'><span class='va'>psq</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'><a href='tax_transform.html'>tax_transform</a></span><span class='op'>(</span><span class='st'>"log2"</span>, zero_replace <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'>comp_heatmap</span><span class='op'>(</span><span class='va'>taxa</span>, anno_tax <span class='op'>=</span> <span class='fu'><a href='heatmap-annotations.html'>tax_anno</a></span><span class='op'>(</span>undetected <span class='op'>=</span> <span class='fl'>50</span><span class='op'>)</span>, name <span class='op'>=</span> <span class='st'>"auto"</span><span class='op'>)</span></span>
<span class='r-plt img'><img src='comp_heatmap-7.png' alt='' width='700' height='433' /></span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by David Barnett.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '22e6f0a75b7b1ffae9bf5bc5b58864d7',
    indexName: 'microViz',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


