<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Aggregate taxa and track aggregation in psExtra — tax_agg • microViz</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Aggregate taxa and track aggregation in psExtra — tax_agg"><meta name="description" content='tax_agg sums the abundances of the phyloseq taxa at the given rank.
It records the tax_agg rank argument in the info of the psExtra object output.
This psExtra object tracks aggregation, and any further transformations and scaling,
to help you keep track of what you have done with your phyloseq object and automatically caption ordination plots.
Instead of tax_agg, consider using tax_transform() with a rank argument instead, to both aggregate and transform the taxa.
This is also useful when you want to aggregate but not transform the taxa,
and yet still log the "identity" transformation in psExtra for captioning your ordination plots.
e.g. tax_transform(rank = "Genus", trans = "identity")
tax_agg allows you to pass NA or "unique" to the rank argument which will NOT aggregate the taxa.
If you use rank = "unique" or add_unique = TRUE, it will add a new rank called unique, identical to the taxa_names (after any aggregation)
Be aware: you should not use the top_N argument yourself without good reason.
top_N provides a feature inspired by the deprecated microbiome function aggregate_top_taxa
which is primarily useful for decluttering compositional barplots.
microViz comp_barplot (and ord_plot_iris) already run tax_agg with a top_N argument for you, so you should not.
The tax_table produced when using top_N is otherwise INVALID FOR MOST OTHER ANALYSES.'><meta property="og:description" content='tax_agg sums the abundances of the phyloseq taxa at the given rank.
It records the tax_agg rank argument in the info of the psExtra object output.
This psExtra object tracks aggregation, and any further transformations and scaling,
to help you keep track of what you have done with your phyloseq object and automatically caption ordination plots.
Instead of tax_agg, consider using tax_transform() with a rank argument instead, to both aggregate and transform the taxa.
This is also useful when you want to aggregate but not transform the taxa,
and yet still log the "identity" transformation in psExtra for captioning your ordination plots.
e.g. tax_transform(rank = "Genus", trans = "identity")
tax_agg allows you to pass NA or "unique" to the rank argument which will NOT aggregate the taxa.
If you use rank = "unique" or add_unique = TRUE, it will add a new rank called unique, identical to the taxa_names (after any aggregation)
Be aware: you should not use the top_N argument yourself without good reason.
top_N provides a feature inspired by the deprecated microbiome function aggregate_top_taxa
which is primarily useful for decluttering compositional barplots.
microViz comp_barplot (and ord_plot_iris) already run tax_agg with a top_N argument for you, so you should not.
The tax_table produced when using top_N is otherwise INVALID FOR MOST OTHER ANALYSES.'><meta property="og:image" content="https://david-barnett.github.io/microViz/logo.png"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-2YQ669S4V5"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-2YQ669S4V5');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">microViz</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.12.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/shao19-analyses.html">Getting Started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/web-only/phyloseq.html">Working with phyloseq objects</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/tax-fixing.html">Fixing your tax_table</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/ordination.html">Ordination plots</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/ordination-interactive.html">Interactive ordination plots</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/compositions.html">Visualising compositions with barplots</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/heatmaps.html">Heatmaps of microbiome composition or correlation</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/modelling-taxa.html">Statistical modelling of individual taxa</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/videos.html">Tutorial video</a></li>
    <li><a class="dropdown-item" href="../articles/ps_extra-replaced.html">Upgrading to microViz version 0.10.0</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/atlas1006.html">Example analyses with atlas1006 data</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/learn/exercises.html">Learn</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item"><h6 class="dropdown-header" data-toc-skip></h6></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/david-barnett/microViz/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Aggregate taxa and track aggregation in psExtra</h1>
      <small class="dont-index">Source: <a href="https://github.com/david-barnett/microViz/blob/main/R/tax_agg.R" class="external-link"><code>R/tax_agg.R</code></a></small>
      <div class="d-none name"><code>tax_agg.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>tax_agg</code> sums the abundances of the phyloseq taxa at the given rank.
It records the tax_agg rank argument in the info of the psExtra object output.
This psExtra object tracks aggregation, and any further transformations and scaling,
to help you keep track of what you have done with your phyloseq object and automatically caption ordination plots.</p>
<p>Instead of tax_agg, consider using <code><a href="tax_transform.html">tax_transform()</a></code> with a rank argument instead, to both aggregate and transform the taxa.
This is also useful when you want to aggregate but not transform the taxa,
and yet still log the "identity" transformation in psExtra for captioning your ordination plots.
e.g. <code>tax_transform(rank = "Genus", trans = "identity")</code></p>
<p>tax_agg allows you to pass NA or "unique" to the rank argument which will NOT aggregate the taxa.
If you use rank = "unique" or add_unique = TRUE, it will add a new rank called unique, identical to the taxa_names (after any aggregation)</p>
<p>Be aware: you should not use the top_N argument yourself without good reason.
top_N provides a feature inspired by the deprecated microbiome function aggregate_top_taxa
which is primarily useful for decluttering compositional barplots.
microViz comp_barplot (and ord_plot_iris) already run tax_agg with a top_N argument for you, so you should not.
The tax_table produced when using top_N is otherwise INVALID FOR MOST OTHER ANALYSES.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tax_agg</span><span class="op">(</span></span>
<span>  <span class="va">ps</span>,</span>
<span>  rank <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  sort_by <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  top_N <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  force <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  add_unique <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-ps">ps<a class="anchor" aria-label="anchor" href="#arg-ps"></a></dt>
<dd><p>phyloseq object</p></dd>


<dt id="arg-rank">rank<a class="anchor" aria-label="anchor" href="#arg-rank"></a></dt>
<dd><p>NA (for tax_names level) or name of valid taxonomic rank (try phyloseq::rank_names(ps)) or "unique"</p></dd>


<dt id="arg-sort-by">sort_by<a class="anchor" aria-label="anchor" href="#arg-sort-by"></a></dt>
<dd><p>if not NA, how should the taxa be sorted, uses tax_sort(), takes same options as <code>by</code> arg</p></dd>


<dt id="arg-top-n">top_N<a class="anchor" aria-label="anchor" href="#arg-top-n"></a></dt>
<dd><p>NA does nothing, but if top_N is a number, it creates an extra tax_table column called top,
which is the same as the unique column for the first top_N number of taxa, and "other" otherwise.</p></dd>


<dt id="arg-force">force<a class="anchor" aria-label="anchor" href="#arg-force"></a></dt>
<dd><p>If TRUE, this forces aggregation at chosen rank to occur regardless of if the output will be sensible!
This avoids the "Taxa not unique at rank: ..." error, but may allow very inappropriate aggregation to occur.
Do not use force = TRUE unless you know why you are doing this, and what the result will be.
If you are getting an error with force = FALSE, it is almost certainly better to examine the tax_table and fix the problem.
force = TRUE is similar to microbiome::aggregate_taxa,
which also does not check that the taxa are uniquely defined by only the aggregation level.</p></dd>


<dt id="arg-add-unique">add_unique<a class="anchor" aria-label="anchor" href="#arg-add-unique"></a></dt>
<dd><p>if TRUE, adds a rank named unique, identical to the rownames after aggregation</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>psExtra object including phyloseq and tax_agg rank info</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is inspired by <code><a href="https://rdrr.io/pkg/microbiome/man/aggregate_taxa.html" class="external-link">microbiome::aggregate_taxa</a></code>.
However if <code><a href="https://rdrr.io/pkg/microbiome/man/aggregate_taxa.html" class="external-link">microbiome::aggregate_taxa</a></code> is used, microViz cannot track this aggregation.</p>
<p>Comparing aggregate_taxa and tax_agg:</p>
<p>Except for the ordering of taxa, and the addition of a "unique" rank being optional (in tax_agg),
the resulting phyloseq objects are identical for aggregating a phyloseq with no ambiguous taxa.
Taxa are ambiguous when the tax_table converges at a lower rank after branching,
such as if two different genera share the same species (e.g. "s__").
<code><a href="https://rdrr.io/pkg/microbiome/man/aggregate_taxa.html" class="external-link">microbiome::aggregate_taxa</a></code> handles ambiguous taxa by creating a "unique" rank with all
of the taxonomic rank info pasted together into one, often very long, name.
<code>tax_agg</code> throws an error, and directs the user to <code><a href="tax_fix.html">tax_fix()</a></code> to fix the ambiguous taxa before aggregation,
which should then result in (much) shorter unique names at the aggregation rank.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="tax_fix.html">tax_fix</a></code></p>
<p><code><a href="tax_fix_interactive.html">tax_fix_interactive</a></code></p>
<p><code><a href="tax_transform.html">tax_transform</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://dx.plos.org/10.1371/journal.pone.0061217" class="external-link">phyloseq</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"dietswap"</span>, package <span class="op">=</span> <span class="st">"microbiome"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">tax_agg</span><span class="op">(</span>ps <span class="op">=</span> <span class="va">dietswap</span>, <span class="st">"Phylum"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="psExtra-accessors.html">ps_get</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/tax_table-methods.html" class="external-link">tax_table</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Taxonomy Table:     [8 taxa by 1 taxonomic ranks]:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 Phylum           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Actinobacteria  "Actinobacteria" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Firmicutes      "Firmicutes"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proteobacteria  "Proteobacteria" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Verrucomicrobia "Verrucomicrobia"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bacteroidetes   "Bacteroidetes"  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spirochaetes    "Spirochaetes"   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fusobacteria    "Fusobacteria"   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cyanobacteria   "Cyanobacteria"  </span>
<span class="r-in"><span><span class="fu">tax_agg</span><span class="op">(</span>ps <span class="op">=</span> <span class="va">dietswap</span>, <span class="st">"Family"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="psExtra-accessors.html">ps_get</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/tax_table-methods.html" class="external-link">tax_table</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Taxonomy Table:     [22 taxa by 2 taxonomic ranks]:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           Phylum            Family                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Actinobacteria            "Actinobacteria"  "Actinobacteria"           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bacilli                   "Firmicutes"      "Bacilli"                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Proteobacteria            "Proteobacteria"  "Proteobacteria"           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Verrucomicrobia           "Verrucomicrobia" "Verrucomicrobia"          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bacteroidetes             "Bacteroidetes"   "Bacteroidetes"            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clostridium cluster XV    "Firmicutes"      "Clostridium cluster XV"   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clostridium cluster XIVa  "Firmicutes"      "Clostridium cluster XIVa" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clostridium cluster IV    "Firmicutes"      "Clostridium cluster IV"   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clostridium cluster XI    "Firmicutes"      "Clostridium cluster XI"   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Asteroleplasma            "Firmicutes"      "Asteroleplasma"           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spirochaetes              "Spirochaetes"    "Spirochaetes"             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clostridium cluster XVI   "Firmicutes"      "Clostridium cluster XVI"  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clostridium cluster XVII  "Firmicutes"      "Clostridium cluster XVII" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clostridium cluster I     "Firmicutes"      "Clostridium cluster I"    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clostridium cluster XVIII "Firmicutes"      "Clostridium cluster XVIII"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clostridium cluster III   "Firmicutes"      "Clostridium cluster III"  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clostridium cluster IX    "Firmicutes"      "Clostridium cluster IX"   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fusobacteria              "Fusobacteria"    "Fusobacteria"             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clostridium cluster XIII  "Firmicutes"      "Clostridium cluster XIII" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cyanobacteria             "Cyanobacteria"   "Cyanobacteria"            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Uncultured Clostridiales  "Firmicutes"      "Uncultured Clostridiales" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Uncultured Mollicutes     "Firmicutes"      "Uncultured Mollicutes"    </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create some missing values</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/tax_table-methods.html" class="external-link">tax_table</a></span><span class="op">(</span><span class="va">dietswap</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">7</span>, <span class="st">"Genus"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"g__"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># this will produce an error, instructing the user to use tax_fix</span></span></span>
<span class="r-in"><span><span class="co"># tax_agg(ps = dietswap, "Genus")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># this will then work:</span></span></span>
<span class="r-in"><span><span class="va">dietswap</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="tax_fix.html">tax_fix</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">tax_agg</span><span class="op">(</span><span class="st">"Genus"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> psExtra object - a phyloseq object with extra slots:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phyloseq-class experiment-level object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> otu_table()   OTU Table:         [ 128 taxa and 222 samples ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample_data() Sample Data:       [ 222 samples by 8 sample variables ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tax_table()   Taxonomy Table:    [ 128 taxa by 3 taxonomic ranks ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> psExtra info:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tax_agg = "Genus" </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># you can replace unknown values with `tax_fix()`</span></span></span>
<span class="r-in"><span><span class="co"># which will fix most problems, like the common "g__" and "s__"</span></span></span>
<span class="r-in"><span><span class="co"># but default tax_fix settings won't catch this long unknown</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/tax_table-methods.html" class="external-link">tax_table</a></span><span class="op">(</span><span class="va">dietswap</span><span class="op">)</span><span class="op">[</span><span class="fl">13</span><span class="op">:</span><span class="fl">17</span>, <span class="st">"Family"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"some_unknown_family"</span></span></span>
<span class="r-in"><span><span class="va">dietswap</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="tax_fix.html">tax_fix</a></span><span class="op">(</span>unknowns <span class="op">=</span> <span class="st">"some_unknown_family"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">tax_agg</span><span class="op">(</span><span class="st">"Family"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> psExtra object - a phyloseq object with extra slots:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phyloseq-class experiment-level object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> otu_table()   OTU Table:         [ 25 taxa and 222 samples ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample_data() Sample Data:       [ 222 samples by 8 sample variables ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tax_table()   Taxonomy Table:    [ 25 taxa by 2 taxonomic ranks ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> psExtra info:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tax_agg = "Family" </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># try tax_fix_interactive() to help you find and fix all the uninformative</span></span></span>
<span class="r-in"><span><span class="co"># and converging values in your taxonomy table.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># the code below won't aggregate taxa,</span></span></span>
<span class="r-in"><span><span class="co"># but just adds a new rank called unique, equal to taxa_names</span></span></span>
<span class="r-in"><span><span class="fu">tax_agg</span><span class="op">(</span>ps <span class="op">=</span> <span class="va">dietswap</span>, rank <span class="op">=</span> <span class="cn">NA</span>, add_unique <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> psExtra object - a phyloseq object with extra slots:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> phyloseq-class experiment-level object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> otu_table()   OTU Table:         [ 130 taxa and 222 samples ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample_data() Sample Data:       [ 222 samples by 8 sample variables ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tax_table()   Taxonomy Table:    [ 130 taxa by 4 taxonomic ranks ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> psExtra info:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tax_agg = "unique" </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu">tax_agg</span><span class="op">(</span><span class="va">dietswap</span>, <span class="cn">NA</span>, add_unique <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fu">tax_agg</span><span class="op">(</span><span class="va">dietswap</span>, <span class="st">"unique"</span><span class="op">)</span><span class="op">)</span> <span class="co"># TRUE</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Barnett.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>



  <script data-goatcounter="https://microviz.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script></body></html>

