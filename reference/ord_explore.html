<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Interactively explore microbial compositions of ordinated samples — ord_explore • microViz</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Interactively explore microbial compositions of ordinated samples — ord_explore"><meta name="description" content="A Shiny app used to create and explore an interactive version of ord_plot().
You can select samples on an ordination plot to view their composition with stacked barplots.
The ord_explore() data argument takes either:
the output of ord_calc() (i.e. a psExtra with an ordination)
a plain phyloseq object: ord_explore() will help you build an ordination


Once the app is running (in your browser), you can:
Create/edit the ordination if required
look at the R console error messages if your chosen options don't build

Style the ordination plot (e.g. choose dimensions; set colour and size; ...)
Taxa loading arrows can be added only to PCA, RDA and CCA plots
Convex hulls or ellipses can only be drawn if Colour is set to a variable
To track individuals over time with the path plotter, your data MUST already be sorted by time (e.g. with ps_arrange)!

Click on or use the lasso tool to select 1 or more samples to view their compositions
By default samples can be selected individually
Set the &quot;Select&quot; option to another variable to select by level of that variable

Style the taxonomic compositions barplot
The samples are ordered using the seriate_method argument and the same transformation and distance as used in the ordination plot
The app may lag if you select 100s of samples and ungroup the &quot;Other&quot; category
To avoid this lag: either reduce the number of taxa or samples, or deselect &quot;Interactive&quot; barplot

Stop the app by clicking the red stop button in the R console
Closing the web browser window doesn't stop the app,
(you can find the app again at the local http address shown in the R console)
Don't forget to copy the ordination plot code before you close the app



See the Details section for some known limitations of the app.
Please report any other app problems on the microViz GitHub issues page."><meta property="og:description" content="A Shiny app used to create and explore an interactive version of ord_plot().
You can select samples on an ordination plot to view their composition with stacked barplots.
The ord_explore() data argument takes either:
the output of ord_calc() (i.e. a psExtra with an ordination)
a plain phyloseq object: ord_explore() will help you build an ordination


Once the app is running (in your browser), you can:
Create/edit the ordination if required
look at the R console error messages if your chosen options don't build

Style the ordination plot (e.g. choose dimensions; set colour and size; ...)
Taxa loading arrows can be added only to PCA, RDA and CCA plots
Convex hulls or ellipses can only be drawn if Colour is set to a variable
To track individuals over time with the path plotter, your data MUST already be sorted by time (e.g. with ps_arrange)!

Click on or use the lasso tool to select 1 or more samples to view their compositions
By default samples can be selected individually
Set the &quot;Select&quot; option to another variable to select by level of that variable

Style the taxonomic compositions barplot
The samples are ordered using the seriate_method argument and the same transformation and distance as used in the ordination plot
The app may lag if you select 100s of samples and ungroup the &quot;Other&quot; category
To avoid this lag: either reduce the number of taxa or samples, or deselect &quot;Interactive&quot; barplot

Stop the app by clicking the red stop button in the R console
Closing the web browser window doesn't stop the app,
(you can find the app again at the local http address shown in the R console)
Don't forget to copy the ordination plot code before you close the app



See the Details section for some known limitations of the app.
Please report any other app problems on the microViz GitHub issues page."><meta property="og:image" content="https://david-barnett.github.io/microViz/logo.png"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-2YQ669S4V5"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-2YQ669S4V5');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">microViz</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.12.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/shao19-analyses.html">Getting Started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/web-only/phyloseq.html">Working with phyloseq objects</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/tax-fixing.html">Fixing your tax_table</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/ordination.html">Ordination plots</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/ordination-interactive.html">Interactive ordination plots</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/compositions.html">Visualising compositions with barplots</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/heatmaps.html">Heatmaps of microbiome composition or correlation</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/modelling-taxa.html">Statistical modelling of individual taxa</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/videos.html">Tutorial video</a></li>
    <li><a class="dropdown-item" href="../articles/ps_extra-replaced.html">Upgrading to microViz version 0.10.0</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/atlas1006.html">Example analyses with atlas1006 data</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/learn/exercises.html">Learn</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item"><h6 class="dropdown-header" data-toc-skip></h6></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/david-barnett/microViz/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Interactively explore microbial compositions of ordinated samples</h1>
      <small class="dont-index">Source: <a href="https://github.com/david-barnett/microViz/blob/main/R/ord_explore.R" class="external-link"><code>R/ord_explore.R</code></a></small>
      <div class="d-none name"><code>ord_explore.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A Shiny app used to create and explore an interactive version of <code><a href="ord_plot.html">ord_plot()</a></code>.
You can select samples on an ordination plot to view their composition with stacked barplots.</p>
<p>The <code>ord_explore()</code> data argument takes either:</p><ul><li><p>the output of <code><a href="ord_calc.html">ord_calc()</a></code> (i.e. a psExtra with an ordination)</p></li>
<li><p>a plain phyloseq object: <code>ord_explore()</code> will help you build an ordination</p></li>
</ul><p>Once the app is running (in your browser), you can:</p><ol><li><p>Create/edit the ordination if required</p><ul><li><p>look at the R console error messages if your chosen options don't build</p></li>
</ul></li>
<li><p>Style the ordination plot (e.g. choose dimensions; set colour and size; ...)</p><ul><li><p>Taxa loading arrows can be added only to PCA, RDA and CCA plots</p></li>
<li><p>Convex hulls or ellipses can only be drawn if Colour is set to a variable</p></li>
<li><p>To track individuals over time with the path plotter, your data MUST already be sorted by time (e.g. with ps_arrange)!</p></li>
</ul></li>
<li><p>Click on or use the lasso tool to select 1 or more samples to view their compositions</p><ul><li><p>By default samples can be selected individually</p></li>
<li><p>Set the "Select" option to another variable to select by level of that variable</p></li>
</ul></li>
<li><p>Style the taxonomic compositions barplot</p><ul><li><p>The samples are ordered using the seriate_method argument and the same transformation and distance as used in the ordination plot</p></li>
<li><p>The app may lag if you select 100s of samples and ungroup the "Other" category</p></li>
<li><p>To avoid this lag: either reduce the number of taxa or samples, or deselect "Interactive" barplot</p></li>
</ul></li>
<li><p>Stop the app by clicking the red stop button in the R console</p><ul><li><p>Closing the web browser window doesn't stop the app,
(you can find the app again at the local http address shown in the R console)</p></li>
<li><p>Don't forget to copy the ordination plot code before you close the app</p></li>
</ul></li>
</ol><p>See the Details section for some known limitations of the app.
Please report any other app problems on the microViz GitHub issues page.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ord_explore</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  sample_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seriate_method <span class="op">=</span> <span class="st">"OLO_ward"</span>,</span>
<span>  app_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>launch.browser <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  plot_widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">9</span><span class="op">)</span>,</span>
<span>  modal_fade <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  notification_durations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>  counts_warn <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>a phyloseq, or the psExtra output of ord_calc</p></dd>


<dt id="arg-sample-id">sample_id<a class="anchor" aria-label="anchor" href="#arg-sample-id"></a></dt>
<dd><p>name of sample ID variable to use as default for selecting samples</p></dd>


<dt id="arg-seriate-method">seriate_method<a class="anchor" aria-label="anchor" href="#arg-seriate-method"></a></dt>
<dd><p>seriation method to order phyloseq samples by similarity</p></dd>


<dt id="arg-app-options">app_options<a class="anchor" aria-label="anchor" href="#arg-app-options"></a></dt>
<dd><p>passed to shinyApp() options argument</p></dd>


<dt id="arg-plot-widths">plot_widths<a class="anchor" aria-label="anchor" href="#arg-plot-widths"></a></dt>
<dd><p>widths of plots in inches, including any legends
(first number is ordination, second is composition barplot)</p></dd>


<dt id="arg-modal-fade">modal_fade<a class="anchor" aria-label="anchor" href="#arg-modal-fade"></a></dt>
<dd><p>should the popover menus (modals) have a fade animation?</p></dd>


<dt id="arg-notification-durations">notification_durations<a class="anchor" aria-label="anchor" href="#arg-notification-durations"></a></dt>
<dd><p>length 2 list giving duration in seconds of short and long notifications
or NULL for notifications that do not disappear automatically</p></dd>


<dt id="arg-counts-warn">counts_warn<a class="anchor" aria-label="anchor" href="#arg-counts-warn"></a></dt>
<dd><p>should a warning be issued if accounts are unavailable?</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments passed to ord_plot</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>nothing, opens default browser</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Limitations:</p><ul><li><p>If a "Select:" grouping variable is NA for some samples,
then that grouping variable cannot be used to select those samples</p></li>
<li><p>"Shape:" can only be mapped to variables with maximum 5 distinct levels,
not including NAs. NAs in the shape variable are shown as hollow circles.</p></li>
</ul><p>On some web browsers, e.g. older versions of Firefox, the numeric inputs'
buttons are sometimes hard to click.
As a workaround, click the box and type a number or use the arrow keys.
This problem occurs in all Shiny apps, not just microViz.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># example code only runs in interactive R session</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://dx.plos.org/10.1371/journal.pone.0061217" class="external-link">phyloseq</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># example of quickstart approach with interactive ordination calculation #</span></span></span>
<span class="r-in"><span>  <span class="fu">microViz</span><span class="fu">::</span><span class="va"><a href="ibd.html">ibd</a></span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="co"># filtering makes subsequent calculations faster</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="tax_filter.html">tax_filter</a></span><span class="op">(</span>min_prevalence <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="tax_fix.html">tax_fix</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">ord_explore</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># simple example with precalculated ordination #</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"enterotype"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/taxa_names-methods.html" class="external-link">taxa_names</a></span><span class="op">(</span><span class="va">enterotype</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"unclassified"</span> <span class="co"># replaces the "-1" taxon name</span></span></span>
<span class="r-in"><span>  <span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="tax_fix.html">tax_fix</a></span><span class="op">(</span><span class="va">enterotype</span><span class="op">)</span> <span class="co"># remove NA taxa</span></span></span>
<span class="r-in"><span>  <span class="va">ord1</span> <span class="op">&lt;-</span> <span class="va">ps</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="tax_transform.html">tax_transform</a></span><span class="op">(</span><span class="st">"identity"</span>, rank <span class="op">=</span> <span class="st">"Genus"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="dist_calc.html">dist_calc</a></span><span class="op">(</span><span class="st">"bray"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="ord_calc.html">ord_calc</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"PCoA"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">ord_explore</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ord1</span>, auto_caption <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># constrained ordination example #</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"dietswap"</span>, package <span class="op">=</span> <span class="st">"microbiome"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># create a couple of numerical variables to use as constraints</span></span></span>
<span class="r-in"><span>  <span class="va">dietswap</span> <span class="op">&lt;-</span> <span class="va">dietswap</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="ps_mutate.html">ps_mutate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      weight <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">bmi_group</span>, obese <span class="op">=</span> <span class="fl">3</span>, overweight <span class="op">=</span> <span class="fl">2</span>, lean <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      female <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">sex</span> <span class="op">==</span> <span class="st">"female"</span>, true <span class="op">=</span> <span class="fl">1</span>, false <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="tax_agg.html">tax_agg</a></span><span class="op">(</span><span class="st">"Genus"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">constrained_aitchison_rda</span> <span class="op">&lt;-</span> <span class="va">dietswap</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="tax_transform.html">tax_transform</a></span><span class="op">(</span><span class="st">"clr"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="ord_calc.html">ord_calc</a></span><span class="op">(</span>constraints <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"weight"</span>, <span class="st">"female"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># label style arguments can be passed to ord_explore</span></span></span>
<span class="r-in"><span>  <span class="va">constrained_aitchison_rda</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">ord_explore</span><span class="op">(</span></span></span>
<span class="r-in"><span>      tax_lab_style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      constraint_lab_style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, auto_caption <span class="op">=</span> <span class="fl">6</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Try changing the point colour to bmi_group or similar</span></span></span>
<span class="r-in"><span>  <span class="co"># Style points interactively!</span></span></span>
<span class="r-in"><span>  <span class="co"># (setting colour/shape/etc as arguments doesn't work)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># dietswap is actually a longitudinal dataset, with multiple samples per</span></span></span>
<span class="r-in"><span>  <span class="co"># subject. If we arrange by timepoint first (!!!), we can use the "paths"</span></span></span>
<span class="r-in"><span>  <span class="co"># additional plot layer from the ord_explore "Add:" menu to track</span></span></span>
<span class="r-in"><span>  <span class="co"># individual subjects over time.</span></span></span>
<span class="r-in"><span>  <span class="va">dietswap</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="ps_arrange.html">ps_arrange</a></span><span class="op">(</span><span class="va">timepoint</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="tax_fix.html">tax_fix</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">ord_explore</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Another dataset, where "size" variable drives gradient on PC1</span></span></span>
<span class="r-in"><span>  <span class="co"># Try setting size and/or alpha to correspond to "size"!</span></span></span>
<span class="r-in"><span>  <span class="co"># Then edit the ordination to use "size" as a condition, see what happens</span></span></span>
<span class="r-in"><span>  <span class="co"># hmp2 &lt;- microbiomeutilities::hmp2</span></span></span>
<span class="r-in"><span>  <span class="va">hmp2</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="tax_fix.html">tax_fix</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="tax_transform.html">tax_transform</a></span><span class="op">(</span>rank <span class="op">=</span> <span class="st">"Genus"</span>, <span class="st">"identity"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="dist_calc.html">dist_calc</a></span><span class="op">(</span><span class="st">"aitchison"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="ord_calc.html">ord_calc</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">ord_explore</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># another dataset</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"soilrep"</span>, package <span class="op">=</span> <span class="st">"phyloseq"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># test auto creation of SAMPLE var</span></span></span>
<span class="r-in"><span>  <span class="va">ps</span> <span class="op">&lt;-</span> <span class="va">soilrep</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="ps_select.html">ps_select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Sample</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># The barplot is actually quite useless with the 16000+ anonymous OTUs</span></span></span>
<span class="r-in"><span>  <span class="co"># in this dataset, but the 1000s of unmerged "Other" categories do render</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="phyloseq_validate.html">phyloseq_validate</a></span><span class="op">(</span><span class="va">ps</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="tax_fix.html">tax_fix</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="dist_calc.html">dist_calc</a></span><span class="op">(</span><span class="st">"aitchison"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="ord_calc.html">ord_calc</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu">ord_explore</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Barnett.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>



  <script data-goatcounter="https://microviz.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script></body></html>

