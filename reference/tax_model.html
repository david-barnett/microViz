<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Statistical modelling for individual taxa in a phyloseq — tax_model • microViz</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Statistical modelling for individual taxa in a phyloseq — tax_model"><meta name="description" content='tax_model provides a simple framework to statistically model the abundance
of individual taxa in your data.
You can choose which type of statistical model you want to fit, and you can
choose at which rank and (optionally) which specific taxa to fit statistical models for.
tax_model takes a phyloseq and returns a list of statistical models, one model for each taxon.
The same independent variables are used for all models,
as specified in variables or formula argument (latter takes precedence).
taxatree_models runs tax_model on every taxon at multiple taxonomic ranks
(you choose which ranks with the plural ranks argument),
and returns the results as a named nested list designed for use with taxatree_plots.
One list per rank, one model per taxon at each rank.
type = "bbdml" will run beta binomial regression model(s) using the corncob package.
For bbdml the same formula/variables is/are used for modelling both the
abundance and dispersion parameters.'><meta property="og:description" content='tax_model provides a simple framework to statistically model the abundance
of individual taxa in your data.
You can choose which type of statistical model you want to fit, and you can
choose at which rank and (optionally) which specific taxa to fit statistical models for.
tax_model takes a phyloseq and returns a list of statistical models, one model for each taxon.
The same independent variables are used for all models,
as specified in variables or formula argument (latter takes precedence).
taxatree_models runs tax_model on every taxon at multiple taxonomic ranks
(you choose which ranks with the plural ranks argument),
and returns the results as a named nested list designed for use with taxatree_plots.
One list per rank, one model per taxon at each rank.
type = "bbdml" will run beta binomial regression model(s) using the corncob package.
For bbdml the same formula/variables is/are used for modelling both the
abundance and dispersion parameters.'><meta property="og:image" content="https://david-barnett.github.io/microViz/logo.png"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-2YQ669S4V5"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-2YQ669S4V5');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">microViz</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.12.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/shao19-analyses.html">Getting Started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/web-only/phyloseq.html">Working with phyloseq objects</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/tax-fixing.html">Fixing your tax_table</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/ordination.html">Ordination plots</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/ordination-interactive.html">Interactive ordination plots</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/compositions.html">Visualising compositions with barplots</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/heatmaps.html">Heatmaps of microbiome composition or correlation</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/modelling-taxa.html">Statistical modelling of individual taxa</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/videos.html">Tutorial video</a></li>
    <li><a class="dropdown-item" href="../articles/ps_extra-replaced.html">Upgrading to microViz version 0.10.0</a></li>
    <li><a class="dropdown-item" href="../articles/web-only/atlas1006.html">Example analyses with atlas1006 data</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/learn/exercises.html">Learn</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item"><h6 class="dropdown-header" data-toc-skip></h6></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/david-barnett/microViz/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Statistical modelling for individual taxa in a phyloseq</h1>
      <small class="dont-index">Source: <a href="https://github.com/david-barnett/microViz/blob/main/R/tax_model.R" class="external-link"><code>R/tax_model.R</code></a></small>
      <div class="d-none name"><code>tax_model.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>tax_model</code> provides a simple framework to statistically model the abundance
of individual taxa in your data.
You can choose which type of statistical model you want to fit, and you can
choose at which rank and (optionally) which specific taxa to fit statistical models for.
<code>tax_model</code> takes a phyloseq and returns a list of statistical models, one model for each taxon.
The same independent variables are used for all models,
as specified in <code>variables</code> or <code>formula</code> argument (latter takes precedence).</p>
<p><code>taxatree_models</code> runs <code>tax_model</code> on every taxon at multiple taxonomic ranks
(you choose which ranks with the plural <code>ranks</code> argument),
and returns the results as a named nested list designed for use with <code>taxatree_plots</code>.
One list per rank, one model per taxon at each rank.</p>
<p><code>type = "bbdml"</code> will run beta binomial regression model(s) using the <code>corncob</code> package.
For bbdml the same formula/variables is/are used for modelling both the
abundance and dispersion parameters.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tax_model</span><span class="op">(</span></span>
<span>  <span class="va">ps</span>,</span>
<span>  <span class="va">rank</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"lm"</span>,</span>
<span>  variables <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  formula <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  taxa <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use_future <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return_psx <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  checkVars <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  checkNA <span class="op">=</span> <span class="st">"warning"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  trans <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  trans_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-ps">ps<a class="anchor" aria-label="anchor" href="#arg-ps"></a></dt>
<dd><p>phyloseq object</p></dd>


<dt id="arg-rank">rank<a class="anchor" aria-label="anchor" href="#arg-rank"></a></dt>
<dd><p>name of taxonomic rank to aggregate to and model taxa at</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>name of modelling function to use, or the function itself</p></dd>


<dt id="arg-variables">variables<a class="anchor" aria-label="anchor" href="#arg-variables"></a></dt>
<dd><p>vector of variable names, to be used as model formula right hand side.
If variables is a list, not a vector, a model is fit for each entry in list.</p></dd>


<dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>Right hand side of a formula, as a formula object or character string. Or a list of these.
(alternative to variables argument, do not provide both)</p></dd>


<dt id="arg-taxa">taxa<a class="anchor" aria-label="anchor" href="#arg-taxa"></a></dt>
<dd><p>taxa to model (named, numbered, logical selection, or defaulting to all if NULL)</p></dd>


<dt id="arg-use-future">use_future<a class="anchor" aria-label="anchor" href="#arg-use-future"></a></dt>
<dd><p>if TRUE parallel processing with future is possible, see details.</p></dd>


<dt id="arg-return-psx">return_psx<a class="anchor" aria-label="anchor" href="#arg-return-psx"></a></dt>
<dd><p>if TRUE, list of results will be returned attached to psExtra object</p></dd>


<dt id="arg-checkvars">checkVars<a class="anchor" aria-label="anchor" href="#arg-checkvars"></a></dt>
<dd><p>should the predictor variables be checked for zero variance?</p></dd>


<dt id="arg-checkna">checkNA<a class="anchor" aria-label="anchor" href="#arg-checkna"></a></dt>
<dd><p>One of "stop", "warning", "message", or "allow", which
indicates whether to check predictor variables for NAs, and how to report any NAs if present?</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>message about progress and any taxa name modifications</p></dd>


<dt id="arg-trans">trans<a class="anchor" aria-label="anchor" href="#arg-trans"></a></dt>
<dd><p>name of tax_transform transformation to apply to aggregated taxa before fitting statistical models</p></dd>


<dt id="arg-trans-args">trans_args<a class="anchor" aria-label="anchor" href="#arg-trans-args"></a></dt>
<dd><p>named list of any additional arguments to tax_transform e.g. list(zero_replace = "halfmin")</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>extra args passed directly to modelling function</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>psExtra with named list of model objects attached.
Or a list of lists of models (if multiple models per taxon).
Or just a list (of lists), if return_psx is FALSE.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>tax_model</code> and <code>taxatree_models</code> can use parallel processing with the <code>future</code> package.
This can speed up analysis if you have many taxa to model. Set use_future = TRUE and
run a line like this before doing your modelling: <code>future::plan(future::multisession, workers = 3)</code>
(This requires the future and future.apply packages to be installed.)</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="psExtra-accessors.html">tax_models_get</a></code> for the accessor to retrieve model results from psExtra</p>
<p><code><a href="taxatree_models.html">taxatree_models</a></code> for more details on the underlying approach</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/statdivlab/corncob" class="external-link">corncob</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dietswap</span>, package <span class="op">=</span> <span class="st">"microbiome"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="va">dietswap</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create some binary variables for easy visualization</span></span></span>
<span class="r-in"><span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="va">ps</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="ps_mutate.html">ps_mutate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  female <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">sex</span> <span class="op">==</span> <span class="st">"female"</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="cn">NaN</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  overweight <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">bmi_group</span> <span class="op">==</span> <span class="st">"overweight"</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="cn">NaN</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  obese <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">bmi_group</span> <span class="op">==</span> <span class="st">"obese"</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="cn">NaN</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This example HITChip dataset has some taxa with the same name for phylum and family...</span></span></span>
<span class="r-in"><span><span class="co"># We can fix problems like this with the tax_prepend_ranks function</span></span></span>
<span class="r-in"><span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="tax_prepend_ranks.html">tax_prepend_ranks</a></span><span class="op">(</span><span class="va">ps</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># filter out rare taxa (it is often difficult to fit multivariable models to rare taxa)</span></span></span>
<span class="r-in"><span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="va">ps</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="tax_filter.html">tax_filter</a></span><span class="op">(</span>min_prevalence <span class="op">=</span> <span class="fl">0.1</span>, min_total_abundance <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Proportional min_prevalence given: 0.1 --&gt; min 23/222 samples.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># specify variables used for modelling</span></span></span>
<span class="r-in"><span><span class="va">VARS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"female"</span>, <span class="st">"overweight"</span>, <span class="st">"obese"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Model first 3 genera using all VARS as predictors (just for a quick test)</span></span></span>
<span class="r-in"><span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu">tax_model</span><span class="op">(</span><span class="va">ps</span>, type <span class="op">=</span> <span class="st">"bbdml"</span>, rank <span class="op">=</span> <span class="st">"Genus"</span>, taxa <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, variables <span class="op">=</span> <span class="va">VARS</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Modelling: G: Akkermansia</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Modelling: G: Allistipes et rel.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Modelling: G: Anaerostipes caccae et rel.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Alternative method using formula arg instead of variables to produce identical results</span></span></span>
<span class="r-in"><span><span class="va">models2</span> <span class="op">&lt;-</span> <span class="fu">tax_model</span><span class="op">(</span></span></span>
<span class="r-in"><span>  ps <span class="op">=</span> <span class="va">ps</span>, rank <span class="op">=</span> <span class="st">"Genus"</span>, type <span class="op">=</span> <span class="st">"bbdml"</span>,</span></span>
<span class="r-in"><span>  taxa <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, formula <span class="op">=</span> <span class="op">~</span> <span class="va">female</span> <span class="op">+</span> <span class="va">overweight</span> <span class="op">+</span> <span class="va">obese</span>, return_psx <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Modelling: G: Akkermansia</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Modelling: G: Allistipes et rel.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Modelling: G: Anaerostipes caccae et rel.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">models</span>, <span class="va">models2</span><span class="op">)</span> <span class="co"># should be TRUE</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Modes: S4, list"                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "Lengths: 1, 3"                                                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "names for current but not for target"                             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4] "Attributes: &lt; names for target but not for current &gt;"             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] "Attributes: &lt; Length mismatch: comparison on first 0 components &gt;"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Model only one genus, NOTE the modified name,</span></span></span>
<span class="r-in"><span><span class="co"># which was returned by tax_prepend_ranks defaults</span></span></span>
<span class="r-in"><span><span class="va">models3</span> <span class="op">&lt;-</span> <span class="va">ps</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">tax_model</span><span class="op">(</span></span></span>
<span class="r-in"><span>    rank <span class="op">=</span> <span class="st">"Genus"</span>, type <span class="op">=</span> <span class="st">"bbdml"</span>,</span></span>
<span class="r-in"><span>    taxa <span class="op">=</span> <span class="st">"G: Bacteroides fragilis et rel."</span>, variables <span class="op">=</span> <span class="va">VARS</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Modelling: G: Bacteroides fragilis et rel.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Model all taxa at multiple taxonomic ranks (ranks 1 and 2)</span></span></span>
<span class="r-in"><span><span class="co"># using only female variable as predictor</span></span></span>
<span class="r-in"><span><span class="va">models4</span> <span class="op">&lt;-</span> <span class="fu"><a href="taxatree_models.html">taxatree_models</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  ps <span class="op">=</span> <span class="va">ps</span>, type <span class="op">=</span> <span class="st">"bbdml"</span>, ranks <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, formula <span class="op">=</span> <span class="op">~</span><span class="va">female</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># modelling proportions with simple linear regression is also possible via type = lm</span></span></span>
<span class="r-in"><span><span class="co"># and transforming the taxa to compositional first</span></span></span>
<span class="r-in"><span><span class="va">models_lm</span> <span class="op">&lt;-</span> <span class="va">ps</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="tax_transform.html">tax_transform</a></span><span class="op">(</span><span class="st">"compositional"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">tax_model</span><span class="op">(</span>rank <span class="op">=</span> <span class="st">"Genus"</span>, taxa <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, variables <span class="op">=</span> <span class="va">VARS</span>, type <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Modelling: G: Akkermansia</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Modelling: G: Allistipes et rel.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Modelling: G: Anaerostipes caccae et rel.</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Barnett.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>



  <script data-goatcounter="https://microviz.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script></body></html>

