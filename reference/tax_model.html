<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Statistical modelling for individual taxa in a phyloseq — tax_model • microViz</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous"><link href="../docsearch.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Statistical modelling for individual taxa in a phyloseq — tax_model"><meta property="og:description" content='tax_model provides a simple framework to statistically model the abundance
of individual taxa in your data.
You can choose which type of statistical model you want to fit, and you can
choose at which rank and (optionally) which specific taxa to fit statistical models for.
tax_model takes a phyloseq and returns a list of statistical models, one model for each taxon.
The same independent variables are used for all models,
as specified in variables or formula argument (latter takes precedence).
taxatree_models runs tax_model on every taxon at multiple taxonomic ranks
(you choose which ranks with the plural ranks argument),
and returns the results as a named nested list designed for use with taxatree_plots.
One list per rank, one model per taxon at each rank.
type = "bbdml" will run beta binomial regression model(s) using the corncob package.
For bbdml the same formula/variables is/are used for modelling both the
abundance and dispersion parameters.'><meta property="og:image" content="https://david-barnett.github.io/microViz/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-2YQ669S4V5"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-2YQ669S4V5');
</script></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">microViz</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.12.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/shao19-analyses.html">Getting Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/web-only/phyloseq.html">Working with phyloseq objects</a>
    </li>
    <li>
      <a href="../articles/web-only/tax-fixing.html">Fixing your tax_table</a>
    </li>
    <li>
      <a href="../articles/web-only/ordination.html">Ordination plots</a>
    </li>
    <li>
      <a href="../articles/web-only/ordination-interactive.html">Interactive ordination plots</a>
    </li>
    <li>
      <a href="../articles/web-only/compositions.html">Visualising compositions with barplots</a>
    </li>
    <li>
      <a href="../articles/web-only/heatmaps.html">Heatmaps of microbiome composition or correlation</a>
    </li>
    <li>
      <a href="../articles/web-only/modelling-taxa.html">Statistical modelling of individual taxa</a>
    </li>
    <li>
      <a href="../articles/web-only/videos.html">Tutorial video</a>
    </li>
    <li>
      <a href="../articles/ps_extra-replaced.html">Upgrading to microViz version 0.10.0</a>
    </li>
    <li>
      <a href="../articles/web-only/atlas1006.html">Example analyses with atlas1006 data</a>
    </li>
  </ul></li>
<li>
  <a href="../articles/learn/exercises.html">Learn</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown-header">
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/david-barnett/microViz/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul><form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off"></div>
      </form>

    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Statistical modelling for individual taxa in a phyloseq</h1>
    <small class="dont-index">Source: <a href="https://github.com/david-barnett/microViz/blob/main/R/tax_model.R" class="external-link"><code>R/tax_model.R</code></a></small>
    <div class="hidden name"><code>tax_model.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>tax_model</code> provides a simple framework to statistically model the abundance
of individual taxa in your data.
You can choose which type of statistical model you want to fit, and you can
choose at which rank and (optionally) which specific taxa to fit statistical models for.
<code>tax_model</code> takes a phyloseq and returns a list of statistical models, one model for each taxon.
The same independent variables are used for all models,
as specified in <code>variables</code> or <code>formula</code> argument (latter takes precedence).</p>
<p><code>taxatree_models</code> runs <code>tax_model</code> on every taxon at multiple taxonomic ranks
(you choose which ranks with the plural <code>ranks</code> argument),
and returns the results as a named nested list designed for use with <code>taxatree_plots</code>.
One list per rank, one model per taxon at each rank.</p>
<p><code>type = "bbdml"</code> will run beta binomial regression model(s) using the <code>corncob</code> package.
For bbdml the same formula/variables is/are used for modelling both the
abundance and dispersion parameters.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tax_model</span><span class="op">(</span></span>
<span>  <span class="va">ps</span>,</span>
<span>  <span class="va">rank</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"lm"</span>,</span>
<span>  variables <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  formula <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  taxa <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use_future <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return_psx <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  checkVars <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  checkNA <span class="op">=</span> <span class="st">"warning"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  trans <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  trans_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-ps">ps<a class="anchor" aria-label="anchor" href="#arg-ps"></a></dt>
<dd><p>phyloseq object</p></dd>


<dt id="arg-rank">rank<a class="anchor" aria-label="anchor" href="#arg-rank"></a></dt>
<dd><p>name of taxonomic rank to aggregate to and model taxa at</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>name of modelling function to use, or the function itself</p></dd>


<dt id="arg-variables">variables<a class="anchor" aria-label="anchor" href="#arg-variables"></a></dt>
<dd><p>vector of variable names, to be used as model formula right hand side.
If variables is a list, not a vector, a model is fit for each entry in list.</p></dd>


<dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>Right hand side of a formula, as a formula object or character string. Or a list of these.
(alternative to variables argument, do not provide both)</p></dd>


<dt id="arg-taxa">taxa<a class="anchor" aria-label="anchor" href="#arg-taxa"></a></dt>
<dd><p>taxa to model (named, numbered, logical selection, or defaulting to all if NULL)</p></dd>


<dt id="arg-use-future">use_future<a class="anchor" aria-label="anchor" href="#arg-use-future"></a></dt>
<dd><p>if TRUE parallel processing with future is possible, see details.</p></dd>


<dt id="arg-return-psx">return_psx<a class="anchor" aria-label="anchor" href="#arg-return-psx"></a></dt>
<dd><p>if TRUE, list of results will be returned attached to psExtra object</p></dd>


<dt id="arg-checkvars">checkVars<a class="anchor" aria-label="anchor" href="#arg-checkvars"></a></dt>
<dd><p>should the predictor variables be checked for zero variance?</p></dd>


<dt id="arg-checkna">checkNA<a class="anchor" aria-label="anchor" href="#arg-checkna"></a></dt>
<dd><p>One of "stop", "warning", "message", or "allow", which
indicates whether to check predictor variables for NAs, and how to report any NAs if present?</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>message about progress and any taxa name modifications</p></dd>


<dt id="arg-trans">trans<a class="anchor" aria-label="anchor" href="#arg-trans"></a></dt>
<dd><p>name of tax_transform transformation to apply to aggregated taxa before fitting statistical models</p></dd>


<dt id="arg-trans-args">trans_args<a class="anchor" aria-label="anchor" href="#arg-trans-args"></a></dt>
<dd><p>named list of any additional arguments to tax_transform e.g. list(zero_replace = "halfmin")</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>extra args passed directly to modelling function</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>psExtra with named list of model objects attached.
Or a list of lists of models (if multiple models per taxon).
Or just a list (of lists), if return_psx is FALSE.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><code>tax_model</code> and <code>taxatree_models</code> can use parallel processing with the <code>future</code> package.
This can speed up analysis if you have many taxa to model. Set use_future = TRUE and
run a line like this before doing your modelling: <code>future::plan(future::multisession, workers = 3)</code>
(This requires the future and future.apply packages to be installed.)</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="psExtra-accessors.html">tax_models_get</a></code> for the accessor to retrieve model results from psExtra</p>
<p><code><a href="taxatree_models.html">taxatree_models</a></code> for more details on the underlying approach</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/statdivlab/corncob" class="external-link">corncob</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dietswap</span>, package <span class="op">=</span> <span class="st">"microbiome"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="va">dietswap</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create some binary variables for easy visualization</span></span></span>
<span class="r-in"><span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="va">ps</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="ps_mutate.html">ps_mutate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  female <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">sex</span> <span class="op">==</span> <span class="st">"female"</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="cn">NaN</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  overweight <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">bmi_group</span> <span class="op">==</span> <span class="st">"overweight"</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="cn">NaN</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  obese <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">bmi_group</span> <span class="op">==</span> <span class="st">"obese"</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="cn">NaN</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This example HITChip dataset has some taxa with the same name for phylum and family...</span></span></span>
<span class="r-in"><span><span class="co"># We can fix problems like this with the tax_prepend_ranks function</span></span></span>
<span class="r-in"><span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="tax_prepend_ranks.html">tax_prepend_ranks</a></span><span class="op">(</span><span class="va">ps</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># filter out rare taxa (it is often difficult to fit multivariable models to rare taxa)</span></span></span>
<span class="r-in"><span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="va">ps</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="tax_filter.html">tax_filter</a></span><span class="op">(</span>min_prevalence <span class="op">=</span> <span class="fl">0.1</span>, min_total_abundance <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Proportional min_prevalence given: 0.1 --&gt; min 23/222 samples.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># specify variables used for modelling</span></span></span>
<span class="r-in"><span><span class="va">VARS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"female"</span>, <span class="st">"overweight"</span>, <span class="st">"obese"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Model first 3 genera using all VARS as predictors (just for a quick test)</span></span></span>
<span class="r-in"><span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu">tax_model</span><span class="op">(</span><span class="va">ps</span>, type <span class="op">=</span> <span class="st">"bbdml"</span>, rank <span class="op">=</span> <span class="st">"Genus"</span>, taxa <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, variables <span class="op">=</span> <span class="va">VARS</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Modelling: G: Akkermansia</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Modelling: G: Allistipes et rel.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Modelling: G: Anaerostipes caccae et rel.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Alternative method using formula arg instead of variables to produce identical results</span></span></span>
<span class="r-in"><span><span class="va">models2</span> <span class="op">&lt;-</span> <span class="fu">tax_model</span><span class="op">(</span></span></span>
<span class="r-in"><span>  ps <span class="op">=</span> <span class="va">ps</span>, rank <span class="op">=</span> <span class="st">"Genus"</span>, type <span class="op">=</span> <span class="st">"bbdml"</span>,</span></span>
<span class="r-in"><span>  taxa <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, formula <span class="op">=</span> <span class="op">~</span> <span class="va">female</span> <span class="op">+</span> <span class="va">overweight</span> <span class="op">+</span> <span class="va">obese</span>, return_psx <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Modelling: G: Akkermansia</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Modelling: G: Allistipes et rel.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Modelling: G: Anaerostipes caccae et rel.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">models</span>, <span class="va">models2</span><span class="op">)</span> <span class="co"># should be TRUE</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Modes: S4, list"                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "Lengths: 1, 3"                                                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "names for current but not for target"                             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4] "Attributes: &lt; names for target but not for current &gt;"             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] "Attributes: &lt; Length mismatch: comparison on first 0 components &gt;"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Model only one genus, NOTE the modified name,</span></span></span>
<span class="r-in"><span><span class="co"># which was returned by tax_prepend_ranks defaults</span></span></span>
<span class="r-in"><span><span class="va">models3</span> <span class="op">&lt;-</span> <span class="va">ps</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">tax_model</span><span class="op">(</span></span></span>
<span class="r-in"><span>    rank <span class="op">=</span> <span class="st">"Genus"</span>, type <span class="op">=</span> <span class="st">"bbdml"</span>,</span></span>
<span class="r-in"><span>    taxa <span class="op">=</span> <span class="st">"G: Bacteroides fragilis et rel."</span>, variables <span class="op">=</span> <span class="va">VARS</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Modelling: G: Bacteroides fragilis et rel.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Model all taxa at multiple taxonomic ranks (ranks 1 and 2)</span></span></span>
<span class="r-in"><span><span class="co"># using only female variable as predictor</span></span></span>
<span class="r-in"><span><span class="va">models4</span> <span class="op">&lt;-</span> <span class="fu"><a href="taxatree_models.html">taxatree_models</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  ps <span class="op">=</span> <span class="va">ps</span>, type <span class="op">=</span> <span class="st">"bbdml"</span>, ranks <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, formula <span class="op">=</span> <span class="op">~</span><span class="va">female</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># modelling proportions with simple linear regression is also possible via type = lm</span></span></span>
<span class="r-in"><span><span class="co"># and transforming the taxa to compositional first</span></span></span>
<span class="r-in"><span><span class="va">models_lm</span> <span class="op">&lt;-</span> <span class="va">ps</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="tax_transform.html">tax_transform</a></span><span class="op">(</span><span class="st">"compositional"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">tax_model</span><span class="op">(</span>rank <span class="op">=</span> <span class="st">"Genus"</span>, taxa <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, variables <span class="op">=</span> <span class="va">VARS</span>, type <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Modelling: G: Akkermansia</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Modelling: G: Allistipes et rel.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Modelling: G: Anaerostipes caccae et rel.</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by David Barnett.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({


    apiKey: '22e6f0a75b7b1ffae9bf5bc5b58864d7',
    indexName: 'microViz',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script><script data-goatcounter="https://microviz.goatcounter.com/count" async src="//gc.zgo.at/count.js"></script></body></html>

