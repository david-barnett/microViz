<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Customisable ggplot2 ordination plot — ord_plot • microViz</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Customisable ggplot2 ordination plot — ord_plot" />
<meta property="og:description" content="Draw ordination plot. Utilises results of ord_calc.
For an extensive tutorial see the ordination vignette.
For interpretation see the the relevant pages on PCA, PCoA, RDA, or CCA on the GUide to STatistical Analysis in Microbial Ecology (GUSTA ME) website: https://sites.google.com/site/mb3gustame/

" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2YQ669S4V5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-2YQ669S4V5');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">microViz</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.8.1.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/web-only/phyloseq.html">Working with phyloseq objects</a>
    </li>
    <li>
      <a href="../articles/web-only/tax-fixing.html">Fixing your tax_table</a>
    </li>
    <li>
      <a href="../articles/web-only/ordination.html">Ordination plots</a>
    </li>
    <li>
      <a href="../articles/web-only/ordination-interactive.html">Interactive ordination plots</a>
    </li>
    <li>
      <a href="../articles/web-only/compositions.html">Visualising microbiota compositions</a>
    </li>
    <li>
      <a href="../articles/web-only/modelling-taxa.html">Statistical modelling of individual taxa</a>
    </li>
    <li>
      <a href="../articles/web-only/videos.html">Tutorial video</a>
    </li>
    <li>
      <a href="../articles/web-only/atlas1006.html">Example analyses with atlas1006 data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown-header"></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/david-barnett/microViz/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Customisable ggplot2 ordination plot</h1>
    <small class="dont-index">Source: <a href='https://github.com/david-barnett/microViz/blob/master/R/ord_plot.R'><code>R/ord_plot.R</code></a></small>
    <div class="hidden name"><code>ord_plot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Draw ordination plot. Utilises results of <code><a href='ord_calc.html'>ord_calc</a></code>.</p><ul>
<li><p>For an extensive tutorial see <a href='https://david-barnett.github.io/microViz/articles/web-only/ordination.html'>the ordination vignette</a>.</p></li>
<li><p>For interpretation see the the relevant pages on PCA, PCoA, RDA, or CCA on the GUide to STatistical Analysis in Microbial Ecology (GUSTA ME) website: <a href='https://sites.google.com/site/mb3gustame/'>https://sites.google.com/site/mb3gustame/</a></p></li>
</ul>

    </div>

    <pre class="usage"><span class='fu'>ord_plot</span><span class='op'>(</span>
  <span class='va'>data</span>,
  axes <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span>,
  plot_taxa <span class='op'>=</span> <span class='cn'>FALSE</span>,
  tax_vec_length <span class='op'>=</span> <span class='cn'>NA</span>,
  tax_vec_style_all <span class='op'>=</span> <span class='fu'><a href='vec_constraint.html'>vec_tax_all</a></span><span class='op'>(</span><span class='op'>)</span>,
  tax_vec_style_sel <span class='op'>=</span> <span class='fu'><a href='vec_constraint.html'>vec_tax_sel</a></span><span class='op'>(</span><span class='op'>)</span>,
  tax_lab_length <span class='op'>=</span> <span class='va'>tax_vec_length</span> <span class='op'>*</span> <span class='fl'>1.1</span>,
  tax_lab_style <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  taxon_renamer <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/identity.html'>identity</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,
  constraint_vec_length <span class='op'>=</span> <span class='cn'>NA</span>,
  constraint_vec_style <span class='op'>=</span> <span class='fu'><a href='vec_constraint.html'>vec_constraint</a></span><span class='op'>(</span><span class='op'>)</span>,
  constraint_lab_length <span class='op'>=</span> <span class='va'>constraint_vec_length</span> <span class='op'>*</span> <span class='fl'>1.1</span>,
  constraint_lab_style <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  var_renamer <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/identity.html'>identity</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>,
  plot_samples <span class='op'>=</span> <span class='cn'>TRUE</span>,
  scaling <span class='op'>=</span> <span class='fl'>2</span>,
  auto_caption <span class='op'>=</span> <span class='fl'>8</span>,
  center <span class='op'>=</span> <span class='cn'>FALSE</span>,
  clip <span class='op'>=</span> <span class='st'>"off"</span>,
  expand <span class='op'>=</span> <span class='op'>!</span><span class='va'>center</span>,
  interactive <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>ps_extra list object, output from ord_calc</p></td>
    </tr>
    <tr>
      <th>axes</th>
      <td><p>which axes to plot: numerical vector of length 2, e.g. 1:2 or c(3,5)</p></td>
    </tr>
    <tr>
      <th>plot_taxa</th>
      <td><p>if ord_calc method was "PCA/RDA" draw the taxa loading vectors (see details)</p></td>
    </tr>
    <tr>
      <th>tax_vec_length</th>
      <td><p>taxon arrow vector scale multiplier.
NA = auto-scaling, or provide a numeric multiplier yourself.</p></td>
    </tr>
    <tr>
      <th>tax_vec_style_all</th>
      <td><p>list of named aesthetic attributes for all (background) taxon vectors</p></td>
    </tr>
    <tr>
      <th>tax_vec_style_sel</th>
      <td><p>list of named aesthetic attributes for taxon vectors for the taxa selected by plot_taxa</p></td>
    </tr>
    <tr>
      <th>tax_lab_length</th>
      <td><p>scale multiplier for label distance/position for any selected taxa</p></td>
    </tr>
    <tr>
      <th>tax_lab_style</th>
      <td><p>list of style options for the taxon labels, see tax_lab_style() function.</p></td>
    </tr>
    <tr>
      <th>taxon_renamer</th>
      <td><p>function that takes any plotted taxon names and returns modified names for labels</p></td>
    </tr>
    <tr>
      <th>constraint_vec_length</th>
      <td><p>constraint arrow vector scale multiplier.
NA = auto-scaling, or provide a numeric multiplier yourself.</p></td>
    </tr>
    <tr>
      <th>constraint_vec_style</th>
      <td><p>list of aesthetics/arguments (colour, alpha etc) for the constraint vectors</p></td>
    </tr>
    <tr>
      <th>constraint_lab_length</th>
      <td><p>label distance/position for any constraints
(relative to default position which is proportional to correlations with each axis)</p></td>
    </tr>
    <tr>
      <th>constraint_lab_style</th>
      <td><p>list of aesthetics/arguments (colour, size etc) for the constraint labels</p></td>
    </tr>
    <tr>
      <th>var_renamer</th>
      <td><p>function to rename constraining variables for plotting their labels</p></td>
    </tr>
    <tr>
      <th>plot_samples</th>
      <td><p>if TRUE, plot sample points with geom_point</p></td>
    </tr>
    <tr>
      <th>scaling</th>
      <td><p>Type 2, or type 1 scaling. For more info, see <a href='https://sites.google.com/site/mb3gustame/constrained-analyses/rda'>https://sites.google.com/site/mb3gustame/constrained-analyses/rda</a>.
Either "species" or "site" scores are scaled by (proportional) eigenvalues, and the other set of scores is left unscaled (from ?vegan::scores.cca)</p></td>
    </tr>
    <tr>
      <th>auto_caption</th>
      <td><p>size of caption with info about the ordination, NA for none</p></td>
    </tr>
    <tr>
      <th>center</th>
      <td><p>expand plot limits to center around origin point (0,0)</p></td>
    </tr>
    <tr>
      <th>clip</th>
      <td><p>clipping of labels that extend outside plot limits?</p></td>
    </tr>
    <tr>
      <th>expand</th>
      <td><p>expand plot limits a little bit further than data range?</p></td>
    </tr>
    <tr>
      <th>interactive</th>
      <td><p>creates plot suitable for use with ggiraph (used in ord_explore)</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>pass aesthetics arguments for sample points,
drawn with geom_point using aes_string</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>ggplot</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>How to specify the plot_taxa argument (when using PCA, CCA or RDA):</p><ul>
<li><p>FALSE --&gt; plot no taxa vectors or labels</p></li>
<li><p>integer vector e.g. 1:3 --&gt; plot labels for top 3 taxa (by longest line length)</p></li>
<li><p>single numeric value e.g. 0.75 --&gt; plot labels for taxa with line length &gt; 0.75</p></li>
<li><p>character vector e.g. c('g__Bacteroides', 'g__Veillonella') --&gt; plot labels for the exactly named taxa</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='Ordination-labels.html'>tax_lab_style</a></code> / <code><a href='Ordination-labels.html'>tax_lab_style</a></code> for styling labels</p>
<p><code><a href='ord_explore.html'>ord_explore</a></code> for interactive ordination plots</p>
<p><code><a href='ord_calc.html'>ord_calc</a></code> for calculating an ordination to plot with ord_plot</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"dietswap"</span>, package <span class='op'>=</span> <span class='st'>"microbiome"</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># create a couple of numerical variables to use as constraints or conditions</span></span>
<span class='r-in'><span class='va'>dietswap</span> <span class='op'>&lt;-</span> <span class='va'>dietswap</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'><a href='ps_mutate.html'>ps_mutate</a></span><span class='op'>(</span></span>
<span class='r-in'>    weight <span class='op'>=</span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/recode.html'>recode</a></span><span class='op'>(</span><span class='va'>bmi_group</span>, obese <span class='op'>=</span> <span class='fl'>3</span>, overweight <span class='op'>=</span> <span class='fl'>2</span>, lean <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,</span>
<span class='r-in'>    female <span class='op'>=</span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>sex</span> <span class='op'>==</span> <span class='st'>"female"</span>, true <span class='op'>=</span> <span class='fl'>1</span>, false <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span></span>
<span class='r-in'>  <span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># unconstrained PCA ordination</span></span>
<span class='r-in'><span class='va'>unconstrained_aitchison_pca</span> <span class='op'>&lt;-</span> <span class='va'>dietswap</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'><a href='tax_transform.html'>tax_transform</a></span><span class='op'>(</span><span class='st'>"clr"</span>, rank <span class='op'>=</span> <span class='st'>"Genus"</span><span class='op'>)</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'><a href='ord_calc.html'>ord_calc</a></span><span class='op'>(</span><span class='op'>)</span> <span class='co'># method = "auto" --&gt; picks PCA as no constraints or distances</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>unconstrained_aitchison_pca</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'>ord_plot</span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"bmi_group"</span>, plot_taxa <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span></span>
<span class='r-in'>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/stat_ellipse.html'>stat_ellipse</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>linetype <span class='op'>=</span> <span class='va'>bmi_group</span>, colour <span class='op'>=</span> <span class='va'>bmi_group</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-plt img'><img src='ord_plot-1.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># you can generate an interactive version of the plot by specifying</span></span>
<span class='r-in'><span class='co'># interactive = TRUE, and passing a variable name to another argument</span></span>
<span class='r-in'><span class='co'># called `data_id` which is required for interactive point selection</span></span>
<span class='r-in'><span class='va'>interactive_plot</span> <span class='op'>&lt;-</span> <span class='va'>unconstrained_aitchison_pca</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'>ord_plot</span><span class='op'>(</span></span>
<span class='r-in'>    colour <span class='op'>=</span> <span class='st'>"bmi_group"</span>, plot_taxa <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>5</span>,</span>
<span class='r-in'>    interactive <span class='op'>=</span> <span class='cn'>TRUE</span>, data_id <span class='op'>=</span> <span class='st'>"sample"</span></span>
<span class='r-in'>  <span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># to start the html viewer, and allow selecting points, we must use a</span></span>
<span class='r-in'><span class='co'># ggiraph function called girafe and set some options and css</span></span>
<span class='r-in'><span class='fu'>ggiraph</span><span class='fu'>::</span><span class='fu'><a href='https://davidgohel.github.io/ggiraph/reference/girafe.html'>girafe</a></span><span class='op'>(</span></span>
<span class='r-in'>  ggobj <span class='op'>=</span> <span class='va'>interactive_plot</span>,</span>
<span class='r-in'>  options <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span class='r-in'>    <span class='fu'>ggiraph</span><span class='fu'>::</span><span class='fu'><a href='https://davidgohel.github.io/ggiraph/reference/opts_selection.html'>opts_selection</a></span><span class='op'>(</span></span>
<span class='r-in'>      css <span class='op'>=</span> <span class='fu'>ggiraph</span><span class='fu'>::</span><span class='fu'><a href='https://davidgohel.github.io/ggiraph/reference/girafe_css.html'>girafe_css</a></span><span class='op'>(</span></span>
<span class='r-in'>        css <span class='op'>=</span> <span class='st'>"fill:orange;stroke:black;"</span>,</span>
<span class='r-in'>        point <span class='op'>=</span> <span class='st'>"stroke-width:1.5px"</span></span>
<span class='r-in'>      <span class='op'>)</span>,</span>
<span class='r-in'>      type <span class='op'>=</span> <span class='st'>"multiple"</span>, <span class='co'># this activates lasso selection (click top-right)</span></span>
<span class='r-in'>      only_shiny <span class='op'>=</span> <span class='cn'>FALSE</span> <span class='co'># allows interactive plot outside of shiny app</span></span>
<span class='r-in'>    <span class='op'>)</span></span>
<span class='r-in'>  <span class='op'>)</span></span>
<span class='r-in'><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># remove effect of weight with conditions arg</span></span>
<span class='r-in'><span class='co'># scaling weight with scale_cc is not necessary as only 1 condition is used</span></span>
<span class='r-in'><span class='va'>dietswap</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'><a href='tax_transform.html'>tax_transform</a></span><span class='op'>(</span><span class='st'>"clr"</span>, rank <span class='op'>=</span> <span class='st'>"Genus"</span><span class='op'>)</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'><a href='ord_calc.html'>ord_calc</a></span><span class='op'>(</span>conditions <span class='op'>=</span> <span class='st'>"weight"</span>, scale_cc <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'>ord_plot</span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"bmi_group"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span class='r-in'>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/stat_ellipse.html'>stat_ellipse</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>linetype <span class='op'>=</span> <span class='va'>bmi_group</span>, colour <span class='op'>=</span> <span class='va'>bmi_group</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-plt img'><img src='ord_plot-2.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># alternatively, constrain variation on weight and female</span></span>
<span class='r-in'><span class='va'>constrained_aitchison_rda</span> <span class='op'>&lt;-</span> <span class='va'>dietswap</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'><a href='tax_transform.html'>tax_transform</a></span><span class='op'>(</span><span class='st'>"clr"</span>, rank <span class='op'>=</span> <span class='st'>"Genus"</span><span class='op'>)</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'><a href='ord_calc.html'>ord_calc</a></span><span class='op'>(</span>constraints <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"weight"</span>, <span class='st'>"female"</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># constraints --&gt; RDA</span></span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> Centering (mean) and scaling (sd) the constraints and conditions: </span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> 	weight</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> 	female</span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>constrained_aitchison_rda</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'>ord_plot</span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"bmi_group"</span>, constraint_vec_length <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span class='r-in'>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/stat_ellipse.html'>stat_ellipse</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>linetype <span class='op'>=</span> <span class='va'>bmi_group</span>, colour <span class='op'>=</span> <span class='va'>bmi_group</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-plt img'><img src='ord_plot-3.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># ggplot allows additional customisation of the resulting plot</span></span>
<span class='r-in'><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>constrained_aitchison_rda</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'>ord_plot</span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"bmi_group"</span>, plot_taxa <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span class='r-in'>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>lims</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>5</span>, <span class='fl'>6</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>5</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span class='r-in'>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_brewer.html'>scale_colour_brewer</a></span><span class='op'>(</span>palette <span class='op'>=</span> <span class='st'>"Set1"</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>p</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/stat_ellipse.html'>stat_ellipse</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>linetype <span class='op'>=</span> <span class='va'>bmi_group</span>, colour <span class='op'>=</span> <span class='va'>bmi_group</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-plt img'><img src='ord_plot-4.png' alt='' width='700' height='433' /></span>
<span class='r-in'><span class='va'>p</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_density_2d.html'>stat_density2d</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='va'>bmi_group</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-plt img'><img src='ord_plot-5.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># you can rename the taxa on the labels with any function that</span></span>
<span class='r-in'><span class='co'># takes and modifies a character vector</span></span>
<span class='r-in'><span class='va'>constrained_aitchison_rda</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'>ord_plot</span><span class='op'>(</span></span>
<span class='r-in'>    colour <span class='op'>=</span> <span class='st'>"bmi_group"</span>,</span>
<span class='r-in'>    plot_taxa <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>,</span>
<span class='r-in'>    taxon_renamer <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'>stringr</span><span class='fu'>::</span><span class='fu'><a href='https://stringr.tidyverse.org/reference/str_extract.html'>str_extract</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='st'>"^."</span><span class='op'>)</span></span>
<span class='r-in'>  <span class='op'>)</span> <span class='op'>+</span></span>
<span class='r-in'>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>lims</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>5</span>, <span class='fl'>6</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>5</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span class='r-in'>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_brewer.html'>scale_colour_brewer</a></span><span class='op'>(</span>palette <span class='op'>=</span> <span class='st'>"Set1"</span><span class='op'>)</span></span>
<span class='r-plt img'><img src='ord_plot-6.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># You can plot PCoA and constrained PCoA plots too.</span></span>
<span class='r-in'><span class='co'># You don't typically need/want to use transformed taxa variables for PCoA</span></span>
<span class='r-in'><span class='co'># But it is good practice to call tax_transform("identity") so that</span></span>
<span class='r-in'><span class='co'># the automatic caption can record that no transformation was applied</span></span>
<span class='r-in'><span class='va'>dietswap</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'><a href='tax_agg.html'>tax_agg</a></span><span class='op'>(</span><span class='st'>"Genus"</span><span class='op'>)</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'><a href='tax_transform.html'>tax_transform</a></span><span class='op'>(</span><span class='st'>"identity"</span><span class='op'>)</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='co'># so caption can record (lack of) transform</span></span>
<span class='r-in'>  <span class='fu'><a href='dist_calc.html'>dist_calc</a></span><span class='op'>(</span><span class='st'>"bray"</span><span class='op'>)</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='co'># bray curtis</span></span>
<span class='r-in'>  <span class='fu'><a href='ord_calc.html'>ord_calc</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='co'># guesses you want an unconstrained PCoA</span></span>
<span class='r-in'>  <span class='fu'>ord_plot</span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"bmi_group"</span><span class='op'>)</span></span>
<span class='r-plt img'><img src='ord_plot-7.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># it is possible to facet these plots</span></span>
<span class='r-in'><span class='co'># (although I'm not sure it makes sense to)</span></span>
<span class='r-in'><span class='co'># but only unconstrained ordination plots and with plot_taxa = FALSE</span></span>
<span class='r-in'><span class='va'>unconstrained_aitchison_pca</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'>ord_plot</span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"sex"</span>, auto_caption <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span> <span class='op'>+</span></span>
<span class='r-in'>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></span><span class='op'>(</span><span class='st'>"sex"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span class='r-in'>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>line <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span class='r-in'>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_density_2d.html'>stat_density2d</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='va'>sex</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span class='r-in'>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span>
<span class='r-wrn co'><span class='r-pr'>#&gt;</span> <span class='warning'>Warning: </span>`guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; = "none")` instead.</span>
<span class='r-plt img'><img src='ord_plot-8.png' alt='' width='700' height='433' /></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>unconstrained_aitchison_pca</span> <span class='op'><a href='%>%.html'>%&gt;%</a></span></span>
<span class='r-in'>  <span class='fu'>ord_plot</span><span class='op'>(</span>color <span class='op'>=</span> <span class='st'>"bmi_group"</span>, plot_samples <span class='op'>=</span> <span class='cn'>FALSE</span>, auto_caption <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span> <span class='op'>+</span></span>
<span class='r-in'>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></span><span class='op'>(</span><span class='st'>"sex"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span class='r-in'>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>line <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>, axis.text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span class='r-in'>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_density_2d.html'>stat_density2d_filled</a></span><span class='op'>(</span>show.legend <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>+</span></span>
<span class='r-in'>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>1</span>, shape <span class='op'>=</span> <span class='fl'>21</span>, colour <span class='op'>=</span> <span class='st'>"black"</span>, fill <span class='op'>=</span> <span class='st'>"white"</span><span class='op'>)</span></span>
<span class='r-plt img'><img src='ord_plot-9.png' alt='' width='700' height='433' /></span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by David Barnett.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '22e6f0a75b7b1ffae9bf5bc5b58864d7',
    indexName: 'microViz',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


