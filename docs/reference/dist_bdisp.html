<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Wrapper for vegan::betadisper — dist_bdisp • microViz</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Wrapper for vegan::betadisper — dist_bdisp" />
<meta property="og:description" content="Takes the output of dist_calc function. Or use with the result of the permanova function to ensure the results correspond to exactly the same input data.
Runs betadisper for all categorical variables in variables argument.
See help('betadisper', package = 'vegan')." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">microViz</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/PCA-sorted-polar-composition-plots.html">PCA-sorted polar composition plots</a>
    </li>
    <li>
      <a href="../articles/tree-development.html">tree-development</a>
    </li>
    <li>
      <a href="../articles/Visualising-compositions.html">Visualising-compositions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/david-barnett/microViz/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Wrapper for vegan::betadisper</h1>
    <small class="dont-index">Source: <a href='https://github.com/david-barnett/microViz/blob/master/R/dist_bdisp.R'><code>R/dist_bdisp.R</code></a></small>
    <div class="hidden name"><code>dist_bdisp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Takes the output of dist_calc function. Or use with the result of the permanova function to ensure the results correspond to exactly the same input data.
Runs betadisper for all categorical variables in variables argument.
See help('betadisper', package = 'vegan').</p>
    </div>

    <pre class="usage"><span class='fu'>dist_bdisp</span><span class='op'>(</span>
  <span class='va'>data</span>,
  <span class='va'>variables</span>,
  method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"centroid"</span>, <span class='st'>"median"</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>,
  complete_cases <span class='op'>=</span> <span class='cn'>TRUE</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>,
  return <span class='op'>=</span> <span class='st'>"all"</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>list output from dist_calc</p></td>
    </tr>
    <tr>
      <th>variables</th>
      <td><p>list of variables to use as group</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>centroid or median</p></td>
    </tr>
    <tr>
      <th>complete_cases</th>
      <td><p>drop samples with NAs in any of the variables listed</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>sends messages about progress if true</p></td>
    </tr>
    <tr>
      <th>return</th>
      <td><p>what parts of return list to return, defaults to all parts</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>list containing betadisper results list and input objects</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://dx.plos.org/10.1371/journal.pone.0061217'>phyloseq</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://cran.r-project.org'>vegan</a></span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Loading required package: permute</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: lattice</span></div><div class='output co'>#&gt; <span class='message'>This is vegan 2.5-7</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"dietswap"</span>, package <span class='op'>=</span> <span class='st'>"microbiome"</span><span class='op'>)</span>

<span class='co'># add some missings to demonstrate automated removal</span>
<span class='fu'><a href='https://rdrr.io/pkg/phyloseq/man/sample_data-methods.html'>sample_data</a></span><span class='op'>(</span><span class='va'>dietswap</span><span class='op'>)</span><span class='op'>$</span><span class='va'>sex</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>:</span><span class='fl'>6</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='cn'>NA</span>
<span class='co'># create a numeric variable to show it will be skipped with a warning</span>
<span class='va'>dietswap</span> <span class='op'>&lt;-</span> <span class='fu'><a href='ps_mutate.html'>ps_mutate</a></span><span class='op'>(</span><span class='va'>dietswap</span>, timepoint <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>timepoint</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># straight to the betadisp</span>
<span class='va'>bd1</span> <span class='op'>&lt;-</span> <span class='va'>dietswap</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='tax_agg.html'>tax_agg</a></span><span class='op'>(</span><span class='st'>"Genus"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='dist_calc.html'>dist_calc</a></span><span class='op'>(</span><span class='st'>"aitchison"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dist_bdisp</span><span class='op'>(</span>variables <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"sex"</span>, <span class='st'>"bmi_group"</span>, <span class='st'>"timepoint"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Dropping samples with missings: 4</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Variable timepoint is skipped as it cannot be used for grouping (class = numeric)</span></div><div class='input'><span class='co'># quick vegan plotting methods</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>bd1</span><span class='op'>$</span><span class='va'>dist_bdisp</span><span class='op'>$</span><span class='va'>sex</span><span class='op'>$</span><span class='va'>model</span>, label.cex <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
</div><div class='img'><img src='dist_bdisp-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/boxplot.html'>boxplot</a></span><span class='op'>(</span><span class='va'>bd1</span><span class='op'>$</span><span class='va'>dist_bdisp</span><span class='op'>$</span><span class='va'>sex</span><span class='op'>$</span><span class='va'>model</span><span class='op'>)</span>
</div><div class='img'><img src='dist_bdisp-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># compute distance and use for both permanova and dist_bdisp</span>
<span class='va'>testDist</span> <span class='op'>&lt;-</span> <span class='va'>dietswap</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='tax_agg.html'>tax_agg</a></span><span class='op'>(</span><span class='st'>"Genus"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='dist_calc.html'>dist_calc</a></span><span class='op'>(</span><span class='st'>"bray"</span><span class='op'>)</span>

<span class='va'>PERM</span> <span class='op'>&lt;-</span> <span class='va'>testDist</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='permanova.html'>permanova</a></span><span class='op'>(</span>
    variables <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"sex"</span>, <span class='st'>"bmi_group"</span><span class='op'>)</span>,
    n_processes <span class='op'>=</span> <span class='fl'>1</span>, n_perms <span class='op'>=</span> <span class='fl'>99</span>
  <span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Dropping samples with missings: 4</span></div><div class='output co'>#&gt; <span class='message'>2021-01-24 19:40:09 - Starting PERMANOVA with 99 perms with 1 processes</span></div><div class='output co'>#&gt; <span class='message'>2021-01-24 19:40:10 - Finished PERMANOVA</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span><span class='op'>(</span><span class='va'>PERM</span>, max.level <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; List of 4
#&gt;  $ info     :List of 3
#&gt;  $ permanova:List of 7
#&gt;   ..- attr(*, "class")= chr "adonis"
#&gt;  $ distMat  : 'dist' num [1:23653] 0.764 0.731 0.728 0.664 0.744 ...
#&gt;   ..- attr(*, "Labels")= chr [1:218] "Sample-1" "Sample-2" "Sample-7" "Sample-8" ...
#&gt;   ..- attr(*, "Size")= int 218
#&gt;   ..- attr(*, "call")= language as.dist.default(m = as.matrix(distMat)[keepers, keepers])
#&gt;   ..- attr(*, "Diag")= logi FALSE
#&gt;   ..- attr(*, "Upper")= logi FALSE
#&gt;  $ ps       :Formal class 'phyloseq' [package "phyloseq"] with 5 slots</div><div class='input'>
<span class='va'>bd</span> <span class='op'>&lt;-</span> <span class='va'>PERM</span> <span class='op'>%&gt;%</span> <span class='fu'>dist_bdisp</span><span class='op'>(</span>variables <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"sex"</span>, <span class='st'>"bmi_group"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Dropping samples with missings: 0</span></div><div class='input'><span class='va'>bd</span><span class='op'>$</span><span class='va'>dist_bdisp</span><span class='op'>$</span><span class='va'>bmi_group</span>
</div><div class='output co'>#&gt; $model
#&gt; 
#&gt; 	Homogeneity of multivariate dispersions
#&gt; 
#&gt; Call: vegan::betadisper(d = distMat, group = metadata[[V]], type =
#&gt; method)
#&gt; 
#&gt; No. of Positive Eigenvalues: 91
#&gt; No. of Negative Eigenvalues: 126
#&gt; 
#&gt; Average distance to centroid:
#&gt;       lean overweight      obese 
#&gt;     0.3617     0.4146     0.4069 
#&gt; 
#&gt; Eigenvalues for PCoA axes:
#&gt; (Showing 8 of 217 eigenvalues)
#&gt;  PCoA1  PCoA2  PCoA3  PCoA4  PCoA5  PCoA6  PCoA7  PCoA8 
#&gt; 16.545  6.630  2.822  2.640  1.892  1.735  1.320  1.115 
#&gt; 
#&gt; $anova
#&gt; Analysis of Variance Table
#&gt; 
#&gt; Response: Distances
#&gt;            Df  Sum Sq  Mean Sq F value   Pr(&gt;F)   
#&gt; Groups      2 0.10092 0.050460  6.7068 0.001495 **
#&gt; Residuals 215 1.61759 0.007524                    
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#&gt; 
#&gt; $tukeyHSD
#&gt;   Tukey multiple comparisons of means
#&gt;     95% family-wise confidence level
#&gt; 
#&gt; Fit: aov(formula = distances ~ group, data = df)
#&gt; 
#&gt; $group
#&gt;                          diff         lwr        upr     p adj
#&gt; overweight-lean   0.052809318  0.01655168 0.08906696 0.0020297
#&gt; obese-lean        0.045195616  0.01020242 0.08018882 0.0072818
#&gt; obese-overweight -0.007613702 -0.03990147 0.02467407 0.8432370
#&gt; 
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by David Barnett.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


